
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The Open Energy Platform is the Frontend of the Open Energy Family and specifically provides a Webapplication which is documented using mkdocs.">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../../scenario-bundles/">
      
      
        
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Technical docs - Open Energy Platform Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../css/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#views" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="Open Energy Platform Documentation" class="md-header__button md-logo" aria-label="Open Energy Platform Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Open Energy Platform Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Technical docs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/OpenEnergyPlatform/oeplatform" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    OpenEnergyFamily/oeplatform
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../installation/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../dev/" class="md-tabs__link">
          
  
  
    
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  
    
  
  Documentation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="Open Energy Platform Documentation" class="md-nav__button md-logo" aria-label="Open Energy Platform Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Open Energy Platform Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OpenEnergyPlatform/oeplatform" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    OpenEnergyFamily/oeplatform
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../installation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Getting Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../installation/guides/installation-docker-dev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../installation/guides/development-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Development setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../installation/guides/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Manual Installation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../dev/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Best Practices
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Best Practices
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../dev/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Software development process
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Software development process
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Frontend and UI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Frontend and UI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev/frontend/workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev/frontend/design-system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev/frontend/accessibility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Accessibility
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Context
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Context
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../dev/context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Context
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../architecture/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Architecture
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_2" id="__nav_4_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Architecture
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/infrastructure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Infrastructure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/project-structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Software Project
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture/modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    oeplatform Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../web-api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Web-API's
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3" id="__nav_4_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Web-API's
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../web-api/oedb-rest-api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    OEDB REST-API
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_3_2" id="__nav_4_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    OEDB REST-API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../web-api/oedb-rest-api/resource-data-size/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Resource data size
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../web-api/oekg-api/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    OEKG API
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    OEKG API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../web-api/oekg-api/scenario-dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Edit scenario datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../apps/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Django Apps
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_5" id="__nav_4_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Django Apps
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../apps/login/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Login
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Features
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_6" id="__nav_4_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6_2" >
        
          
          <label class="md-nav__link" for="__nav_4_6_2" id="__nav_4_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ðŸš§ OEP-Datasets
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    ðŸš§ OEP-Datasets
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../oep-datasets/datasets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Datasets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../oep-datasets/tech-stack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tech stack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6_3" >
        
          
          <label class="md-nav__link" for="__nav_4_6_3" id="__nav_4_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    ðŸš§ðŸ”„ Upload-Wizard
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    ðŸš§ðŸ”„ Upload-Wizard
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../upload-wizard/tabular-data-upload/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tabular data upload
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../metaBuilder/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    metaBuilder (Metadata creation)
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    metaBuilder (Metadata creation)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6_5" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    ðŸš§ Open Peer Review
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_6_5" id="__nav_4_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_6_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_6_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    ðŸš§ Open Peer Review
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Technical docs
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Technical docs
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#views" class="md-nav__link">
    <span class="md-ellipsis">
      
        Views
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Views">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peerreviewview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReviewView
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerReviewView">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView" class="md-nav__link">
    <span class="md-ellipsis">
      
        TablePeerReviewView
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.get_all_field_descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_field_descriptions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.load_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.load_json_schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_json_schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.parse_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.post" class="md-nav__link">
    <span class="md-ellipsis">
      
        post
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.sort_in_category" class="md-nav__link">
    <span class="md-ellipsis">
      
        sort_in_category
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peerrreviewcontributorview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerRreviewContributorView
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerRreviewContributorView">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerRreviewContributorView" class="md-nav__link">
    <span class="md-ellipsis">
      
        TablePeerRreviewContributorView
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerRreviewContributorView.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerRreviewContributorView.post" class="md-nav__link">
    <span class="md-ellipsis">
      
        post
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Helper Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.helper" class="md-nav__link">
    <span class="md-ellipsis">
      
        helper
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.add_tag" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_tag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.change_requests" class="md-nav__link">
    <span class="md-ellipsis">
      
        change_requests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.delete_peer_review" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_peer_review
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.edit_tag" class="md-nav__link">
    <span class="md-ellipsis">
      
        edit_tag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.find_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.get_all_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.get_column_description" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_column_description
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.get_review_for_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_review_for_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.merge_field_reviews" class="md-nav__link">
    <span class="md-ellipsis">
      
        merge_field_reviews
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.recursive_update" class="md-nav__link">
    <span class="md-ellipsis">
      
        recursive_update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.set_nested_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_nested_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.update_keywords_from_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_keywords_from_tags
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metadata Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metadata Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-metadata-to-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Save Metadata to Database
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Save Metadata to Database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.metadata.save_metadata_to_db" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_metadata_to_db
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-metadata-from-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load Metadata from Database
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Load Metadata from Database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.metadata.load_metadata_from_db" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_metadata_from_db
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peerreview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerReview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.delete" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.get_prev_and_next_reviews" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_prev_and_next_reviews
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.set_version_of_metadata_for_review" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_version_of_metadata_for_review
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peerreviewmanager" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReviewManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerReviewManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReviewManager
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_latest_open_opr_by_contributor" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_latest_open_opr_by_contributor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_latest_open_opr_by_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_latest_open_opr_by_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_opr_by_contributor" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_opr_by_contributor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_opr_by_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_opr_by_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_opr_by_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_opr_by_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.load_contributor" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_contributor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.load_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.set_next_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_next_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.update_open_since" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_open_since
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.whos_turn" class="md-nav__link">
    <span class="md-ellipsis">
      
        whos_turn
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_6_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../scenario-bundles/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Scenario Bundles
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_6_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_6_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Scenario Bundles
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#views" class="md-nav__link">
    <span class="md-ellipsis">
      
        Views
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Views">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peerreviewview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReviewView
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerReviewView">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView" class="md-nav__link">
    <span class="md-ellipsis">
      
        TablePeerReviewView
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.get_all_field_descriptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_field_descriptions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.load_json" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_json
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.load_json_schema" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_json_schema
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.parse_keys" class="md-nav__link">
    <span class="md-ellipsis">
      
        parse_keys
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.post" class="md-nav__link">
    <span class="md-ellipsis">
      
        post
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerReviewView.sort_in_category" class="md-nav__link">
    <span class="md-ellipsis">
      
        sort_in_category
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peerrreviewcontributorview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerRreviewContributorView
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerRreviewContributorView">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerRreviewContributorView" class="md-nav__link">
    <span class="md-ellipsis">
      
        TablePeerRreviewContributorView
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerRreviewContributorView.get" class="md-nav__link">
    <span class="md-ellipsis">
      
        get
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.views.TablePeerRreviewContributorView.post" class="md-nav__link">
    <span class="md-ellipsis">
      
        post
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Helper Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Helper Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.helper" class="md-nav__link">
    <span class="md-ellipsis">
      
        helper
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.add_tag" class="md-nav__link">
    <span class="md-ellipsis">
      
        add_tag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.change_requests" class="md-nav__link">
    <span class="md-ellipsis">
      
        change_requests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.delete_peer_review" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete_peer_review
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.edit_tag" class="md-nav__link">
    <span class="md-ellipsis">
      
        edit_tag
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.find_tables" class="md-nav__link">
    <span class="md-ellipsis">
      
        find_tables
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.get_all_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_all_tags
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.get_column_description" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_column_description
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.get_review_for_key" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_review_for_key
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.merge_field_reviews" class="md-nav__link">
    <span class="md-ellipsis">
      
        merge_field_reviews
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.recursive_update" class="md-nav__link">
    <span class="md-ellipsis">
      
        recursive_update
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.set_nested_value" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_nested_value
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.helper.update_keywords_from_tags" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_keywords_from_tags
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-functions" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metadata Functions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metadata Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save-metadata-to-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Save Metadata to Database
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Save Metadata to Database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.metadata.save_metadata_to_db" class="md-nav__link">
    <span class="md-ellipsis">
      
        save_metadata_to_db
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load-metadata-from-database" class="md-nav__link">
    <span class="md-ellipsis">
      
        Load Metadata from Database
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Load Metadata from Database">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.metadata.load_metadata_from_db" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_metadata_from_db
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#models" class="md-nav__link">
    <span class="md-ellipsis">
      
        Models
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#peerreview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerReview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.delete" class="md-nav__link">
    <span class="md-ellipsis">
      
        delete
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.get_prev_and_next_reviews" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_prev_and_next_reviews
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.set_version_of_metadata_for_review" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_version_of_metadata_for_review
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReview.update" class="md-nav__link">
    <span class="md-ellipsis">
      
        update
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#peerreviewmanager" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReviewManager
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PeerReviewManager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager" class="md-nav__link">
    <span class="md-ellipsis">
      
        PeerReviewManager
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_latest_open_opr_by_contributor" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_latest_open_opr_by_contributor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_latest_open_opr_by_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_latest_open_opr_by_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_opr_by_contributor" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_opr_by_contributor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_opr_by_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_opr_by_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.filter_opr_by_table" class="md-nav__link">
    <span class="md-ellipsis">
      
        filter_opr_by_table
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.load" class="md-nav__link">
    <span class="md-ellipsis">
      
        load
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.load_contributor" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_contributor
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.load_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        load_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.save" class="md-nav__link">
    <span class="md-ellipsis">
      
        save
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.set_next_reviewer" class="md-nav__link">
    <span class="md-ellipsis">
      
        set_next_reviewer
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.update_open_since" class="md-nav__link">
    <span class="md-ellipsis">
      
        update_open_since
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dataedit.models.PeerReviewManager.whos_turn" class="md-nav__link">
    <span class="md-ellipsis">
      
        whos_turn
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../../" class="md-path__link">
          
  <span class="md-ellipsis">
    Documentation
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../" class="md-path__link">
          
  <span class="md-ellipsis">
    Features
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../" class="md-path__link">
          
  <span class="md-ellipsis">
    ðŸš§ Open Peer Review
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Technical docs</h1>

<!--
SPDX-FileCopyrightText: 2025 Jonas Huber <https://github.com/jh-RLI> Â© Reiner Lemoine Institut

SPDX-License-Identifier: CC0-1.0
-->

<h2 id="views">Views<a class="headerlink" href="#views" title="Permanent link">#</a></h2>
<p>Django views.</p>
<h3 id="peerreviewview">PeerReviewView<a class="headerlink" href="#peerreviewview" title="Permanent link">#</a></h3>
<p>View for the reviewer role of the Open Peer Review process.</p>


<div class="doc doc-object doc-class">



<a id="dataedit.views.TablePeerReviewView"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="django.contrib.auth.mixins.LoginRequiredMixin">LoginRequiredMixin</span></code>, <code><span title="django.views.generic.View">View</span></code></p>



        <p>A view handling the peer review of metadata. This view supports loading,
parsing, sorting metadata, and handling GET and POST requests for peer review.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>dataedit/views.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TablePeerReviewView</span><span class="p">(</span><span class="n">LoginRequiredMixin</span><span class="p">,</span> <span class="n">View</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view handling the peer review of metadata. This view supports loading,</span>
<span class="sd">    parsing, sorting metadata, and handling GET and POST requests for peer review.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load JSON metadata from the database. If the review_id is available</span>
<span class="sd">        then load the metadata form the peer review instance and not from the</span>
<span class="sd">        table. This avoids changes to the metadata that is or was reviewed.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): The name of the table.</span>
<span class="sd">            review_id (int): Id of a peer review in the django database</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Loaded oemetadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">review_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_metadata_from_db</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">review_id</span><span class="p">:</span>
            <span class="n">opr</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="n">opr</span><span class="o">.</span><span class="n">oemetadata</span>

        <span class="k">return</span> <span class="n">metadata</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_json_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the JSON schema used for validating metadata.</span>

<span class="sd">        Note:</span>
<span class="sd">            Update this method if a new oemetadata version is released.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="n">OEMETADATA_V20_SCHEMA</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Recursively parse keys from a nested dictionary or list and return them</span>
<span class="sd">        as a list of dictionaries.</span>

<span class="sd">        Args:</span>
<span class="sd">            val (dict or list): The input dictionary or list to parse.</span>
<span class="sd">            old (str, optional): The prefix for nested keys. Defaults to an</span>
<span class="sd">                empty string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: A list of dictionaries, each containing &#39;field&#39; and &#39;value&#39;</span>
<span class="sd">                keys.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">lines</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_keys</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">old</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
                <span class="c1"># handles empty list</span>
                <span class="n">lines</span> <span class="o">+=</span> <span class="p">[{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">old</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)}]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                    <span class="n">lines</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_keys</span><span class="p">(</span>
                        <span class="n">k</span><span class="p">,</span> <span class="n">old</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                    <span class="p">)</span>  <span class="c1"># handles user value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">+=</span> <span class="p">[{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">old</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)}]</span>
        <span class="k">return</span> <span class="n">lines</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_in_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">oemetadata</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Group flattened OEMetadata v2 fields into thematic buckets and attach</span>
<span class="sd">        placeholders required by the review UI.</span>

<span class="sd">        Each entry has six keys:</span>
<span class="sd">        {</span>
<span class="sd">          &quot;field&quot;: &quot;&lt;dot-path&gt;&quot;,</span>
<span class="sd">          &quot;label&quot;: &quot;&lt;display label without &#39;resources.&lt;idx&gt;.&#39;&gt;&quot;,</span>
<span class="sd">          &quot;value&quot;: &quot;&lt;current value&gt;&quot;,</span>
<span class="sd">          &quot;newValue&quot;: &quot;&quot;,</span>
<span class="sd">          &quot;reviewer_suggestion&quot;: &quot;&quot;,</span>
<span class="sd">          &quot;suggestion_comment&quot;: &quot;&quot;</span>
<span class="sd">        }</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">flattened</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_keys</span><span class="p">(</span><span class="n">oemetadata</span><span class="p">)</span>
        <span class="n">flattened</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">flattened</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;resources.&quot;</span><span class="p">)</span>
        <span class="p">]</span>

        <span class="n">bucket_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;spatial&quot;</span><span class="p">:</span> <span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal&quot;</span><span class="p">:</span> <span class="s2">&quot;temporal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;licenses&quot;</span><span class="p">:</span> <span class="s2">&quot;license&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">make_label</span><span class="p">(</span><span class="n">dot_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># remove leading resources.&lt;idx&gt;.</span>
            <span class="n">trimmed</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^resources\.[0-9]+\.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dot_path</span><span class="p">)</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">trimmed</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;@id&quot;</span><span class="p">,</span> <span class="s2">&quot;@type&quot;</span><span class="p">}:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">out</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

        <span class="n">tmp</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">flattened</span><span class="p">:</span>
            <span class="n">raw_key</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">raw_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;resources&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">root</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">root</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">bucket</span> <span class="o">=</span> <span class="n">bucket_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;general&quot;</span><span class="p">)</span>

            <span class="n">tmp</span><span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">raw_key</span><span class="p">,</span>
                    <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">make_label</span><span class="p">(</span><span class="n">raw_key</span><span class="p">),</span>
                    <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;newValue&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;reviewer_suggestion&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;suggestion_comment&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;general&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span>
            <span class="s2">&quot;spatial&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">],</span>
            <span class="s2">&quot;temporal&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;temporal&quot;</span><span class="p">],</span>
            <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span>
            <span class="s2">&quot;license&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">],</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_all_field_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Collects the field title, descriptions, examples, and badge information</span>
<span class="sd">        for each field of the oemetadata from the JSON schema and prepares them</span>
<span class="sd">        for further processing.</span>

<span class="sd">        Args:</span>
<span class="sd">            json_schema (dict): The JSON schema to extract field descriptions</span>
<span class="sd">                from.</span>
<span class="sd">            prefix (str, optional): The prefix for nested keys. Defaults to an</span>
<span class="sd">                empty string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary containing field descriptions, examples, and</span>
<span class="sd">                other information.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">field_descriptions</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">extract_descriptions</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="n">field</span>

                <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                    <span class="n">attr</span> <span class="ow">in</span> <span class="n">value</span>
                    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;examples&quot;</span><span class="p">,</span> <span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="s2">&quot;badge&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">if</span> <span class="s2">&quot;description&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
                    <span class="c1"># Prefer v2 &quot;examples&quot; (array) over v1 &quot;example&quot; (single value)</span>
                    <span class="k">if</span> <span class="s2">&quot;examples&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;examples&quot;</span><span class="p">]:</span>
                        <span class="c1"># v2: first item of the examples array</span>
                        <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;example&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;examples&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="s2">&quot;example&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                        <span class="c1"># v1 fallback</span>
                        <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;example&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;badge&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;badge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;badge&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                        <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">new_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="n">field</span>
                    <span class="n">extract_descriptions</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">],</span> <span class="n">new_prefix</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;items&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">new_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="n">field</span>
                    <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]:</span>
                        <span class="n">extract_descriptions</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">],</span> <span class="n">new_prefix</span><span class="p">)</span>

        <span class="n">extract_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">],</span> <span class="n">prefix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">field_descriptions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span>
        <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">review_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle GET requests for peer review.</span>
<span class="sd">        Loads necessary data and renders the review template.</span>

<span class="sd">        Args:</span>
<span class="sd">            request (HttpRequest): The incoming HTTP GET request.</span>
<span class="sd">            table (str): The name of the table.</span>
<span class="sd">            review_id (int, optional): The ID of the review. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HttpResponse: Rendered HTML response.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">table_obj</span> <span class="o">=</span> <span class="n">table_or_404</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
        <span class="n">topic</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span>

        <span class="c1"># review_state = PeerReview.is_finished  # TODO: Use later</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json_schema</span><span class="p">()</span>
        <span class="n">can_add</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">field_descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_field_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

        <span class="c1"># Check user permissions</span>
        <span class="n">user</span><span class="p">:</span> <span class="n">login_models</span><span class="o">.</span><span class="n">myuser</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">is_anonymous</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get_table_permission_level</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
            <span class="n">can_add</span> <span class="o">=</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="n">login</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">WRITE_PERM</span>

        <span class="n">oemetadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_in_category</span><span class="p">(</span>
            <span class="n">table</span><span class="p">,</span> <span class="n">oemetadata</span><span class="o">=</span><span class="n">oemetadata</span>
        <span class="p">)</span>  <span class="c1"># Generate URL for peer_review_reviewer</span>
        <span class="k">if</span> <span class="n">review_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">url_peer_review</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span>
                <span class="s2">&quot;dataedit:peer_review_reviewer&quot;</span><span class="p">,</span>
                <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">,</span> <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">},</span>
            <span class="p">)</span>
            <span class="n">opr_review</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>

            <span class="n">existing_review</span> <span class="o">=</span> <span class="p">(</span><span class="n">opr_review</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviews&quot;</span><span class="p">,</span> <span class="p">[])</span>
            <span class="n">review_finished</span> <span class="o">=</span> <span class="n">opr_review</span><span class="o">.</span><span class="n">is_finished</span>
            <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;general&quot;</span><span class="p">,</span>
                <span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
                <span class="s2">&quot;temporal&quot;</span><span class="p">,</span>
                <span class="s2">&quot;source&quot;</span><span class="p">,</span>
                <span class="s2">&quot;license&quot;</span><span class="p">,</span>
            <span class="p">]</span>
            <span class="n">state_dict</span> <span class="o">=</span> <span class="n">process_review_data</span><span class="p">(</span>
                <span class="n">review_data</span><span class="o">=</span><span class="n">existing_review</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url_peer_review</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span>
                <span class="s2">&quot;dataedit:peer_review_create&quot;</span><span class="p">,</span>
                <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">},</span>
            <span class="p">)</span>
            <span class="c1"># existing_review={}</span>
            <span class="n">state_dict</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">review_finished</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">config_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;can_add&quot;</span><span class="p">:</span> <span class="n">can_add</span><span class="p">,</span>
            <span class="s2">&quot;url_peer_review&quot;</span><span class="p">:</span> <span class="n">url_peer_review</span><span class="p">,</span>
            <span class="s2">&quot;url_table&quot;</span><span class="p">:</span> <span class="n">reverse</span><span class="p">(</span><span class="s2">&quot;dataedit:view&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">}),</span>
            <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">topic</span><span class="p">,</span>
            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">,</span>
            <span class="s2">&quot;review_finished&quot;</span><span class="p">:</span> <span class="n">review_finished</span><span class="p">,</span>
            <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">context_meta</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># need this here as json.dumps breaks the template syntax access</span>
            <span class="c1"># like {{ config.table }} now you can use {{ table }}</span>
            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">,</span>
            <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span><span class="p">,</span>
            <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">config_data</span><span class="p">),</span>
            <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
            <span class="s2">&quot;json_schema&quot;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">,</span>
            <span class="s2">&quot;field_descriptions_json&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">field_descriptions</span><span class="p">),</span>
            <span class="s2">&quot;state_dict&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state_dict</span><span class="p">),</span>
            <span class="s2">&quot;review_finished&quot;</span><span class="p">:</span> <span class="n">review_finished</span><span class="p">,</span>
            <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_review.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context_meta</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle POST requests for submitting reviews by the reviewer.</span>

<span class="sd">        This method:</span>
<span class="sd">        - Creates (or saves) reviews in the PeerReview table.</span>
<span class="sd">        - Updates the review finished attribute in the dataedit.Tables table,</span>
<span class="sd">            indicating that the table can be moved from the model draft topic.</span>

<span class="sd">        Missing parts:</span>
<span class="sd">        - once the opr is finished (all field reviews agreed on)</span>
<span class="sd">        - merge field review results to metadata on table</span>
<span class="sd">        - awarde a badge</span>
<span class="sd">            - is field filled in?</span>
<span class="sd">            - calculate the badge by comparing filled fields</span>
<span class="sd">              and the badges form metadata schema</span>

<span class="sd">        Args:</span>
<span class="sd">            request (HttpRequest): The incoming HTTP POST request.</span>
<span class="sd">            table (str): The name of the table.</span>
<span class="sd">            review_id (int, optional): The ID of the review. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HttpResponse: Rendered HTML response for the review.</span>

<span class="sd">        Raises:</span>
<span class="sd">            JsonResponse: If any error occurs, a JsonResponse containing the</span>
<span class="sd">            error message is raised.</span>

<span class="sd">        Note:</span>
<span class="sd">            - There are some missing parts in this method. Once the review process</span>
<span class="sd">                is finished (all field reviews agreed on), it should merge field</span>
<span class="sd">                review results to metadata on the table and award a badge based</span>
<span class="sd">                on certain criteria.</span>
<span class="sd">            - A notification should be sent to the user if he/she can&#39;t review tables</span>
<span class="sd">            for which he/she is the table holder (TODO).</span>
<span class="sd">            - After a review is finished, the table&#39;s metadata is updated, and the table</span>
<span class="sd">            can be moved to a different topic (TODO).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_obj</span> <span class="o">=</span> <span class="n">table_or_404</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

        <span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">user</span><span class="p">:</span> <span class="n">login_models</span><span class="o">.</span><span class="n">myuser</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>  <span class="c1"># type: ignore</span>

        <span class="c1"># get the review data and additional application metadata</span>
        <span class="c1"># from user peer review submit/save</span>
        <span class="n">review_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">review_id</span><span class="p">:</span>
            <span class="n">contributor_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">contributor_review</span><span class="p">:</span>
                <span class="n">contributor_review_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">contributor_review</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s2">&quot;reviews&quot;</span><span class="p">,</span> <span class="p">[]</span>
                <span class="p">)</span>
                <span class="n">review_data</span><span class="p">[</span><span class="s2">&quot;reviewData&quot;</span><span class="p">][</span><span class="s2">&quot;reviews&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributor_review_data</span><span class="p">)</span>

        <span class="c1"># The type can be &quot;save&quot; or &quot;submit&quot; as this triggers different behavior</span>
        <span class="n">review_post_type</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewType&quot;</span><span class="p">)</span>
        <span class="c1"># The opr datamodel that includes the field review data and metadata</span>
        <span class="n">review_datamodel</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewData&quot;</span><span class="p">)</span>
        <span class="n">review_finished</span> <span class="o">=</span> <span class="n">review_datamodel</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewFinished&quot;</span><span class="p">)</span>
        <span class="c1"># TODO: Send a notification to the user that he can&#39;t review tables</span>
        <span class="c1"># he is the table holder.</span>
        <span class="k">if</span> <span class="n">review_post_type</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">delete_peer_review</span><span class="p">(</span><span class="n">review_id</span><span class="p">)</span>

        <span class="n">contributor</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">load_contributor</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">contributor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># ÃœberprÃ¼fen, ob ein aktiver PeerReview existiert</span>
            <span class="n">active_peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">active_peer_review</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">active_peer_review</span><span class="o">.</span><span class="n">is_finished</span><span class="p">:</span>
                <span class="c1"># Kein aktiver PeerReview vorhanden</span>
                <span class="c1"># oder der aktive PeerReview ist abgeschlossen</span>
                <span class="n">table_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="p">(</span>
                    <span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">is_finished</span><span class="o">=</span><span class="n">review_finished</span><span class="p">,</span>
                    <span class="n">review</span><span class="o">=</span><span class="n">review_datamodel</span><span class="p">,</span>
                    <span class="n">reviewer</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                    <span class="n">contributor</span><span class="o">=</span><span class="n">contributor</span><span class="p">,</span>
                    <span class="n">oemetadata</span><span class="o">=</span><span class="n">load_metadata_from_db</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">table_review</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">review_type</span><span class="o">=</span><span class="n">review_post_type</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Aktiver PeerReview ist vorhanden ... aktualisieren</span>
                <span class="n">current_review_data</span> <span class="o">=</span> <span class="n">active_peer_review</span><span class="o">.</span><span class="n">review</span>
                <span class="n">merged_review_data</span> <span class="o">=</span> <span class="n">merge_field_reviews</span><span class="p">(</span>
                    <span class="n">current_json</span><span class="o">=</span><span class="n">current_review_data</span><span class="p">,</span> <span class="n">new_json</span><span class="o">=</span><span class="n">review_datamodel</span>
                <span class="p">)</span>

                <span class="c1"># Set new review values and update existing review</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">merged_review_data</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">reviewer</span> <span class="o">=</span> <span class="n">user</span>  <span class="c1"># type:ignore TODO why type warning?</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">contributor</span> <span class="o">=</span> <span class="n">contributor</span>  <span class="c1"># type:ignore TODO</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">review_type</span><span class="o">=</span><span class="n">review_post_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Failed to retrieve any user that identifies &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;as table holder for the current table: </span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">error_msg</span><span class="p">},</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

        <span class="c1"># TODO: Check for topic as reviewed finished also indicates the table</span>
        <span class="c1"># needs to be or has to be moved.</span>
        <span class="k">if</span> <span class="n">review_finished</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">review_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">review_table</span><span class="o">.</span><span class="n">set_is_reviewed</span><span class="p">()</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
            <span class="n">updated_metadata</span> <span class="o">=</span> <span class="n">recursive_update</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">review_data</span><span class="p">)</span>
            <span class="n">save_metadata_to_db</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">updated_metadata</span><span class="p">)</span>
            <span class="n">active_peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">active_peer_review</span><span class="p">:</span>
                <span class="n">updated_oemetadata</span> <span class="o">=</span> <span class="n">recursive_update</span><span class="p">(</span>
                    <span class="n">active_peer_review</span><span class="o">.</span><span class="n">oemetadata</span><span class="p">,</span> <span class="n">review_data</span>
                <span class="p">)</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">oemetadata</span> <span class="o">=</span> <span class="n">updated_oemetadata</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

            <span class="c1"># TODO: also update reviewFinished in review datamodel json</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_review.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerReviewView.get" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Handle GET requests for peer review.
Loads necessary data and renders the review template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>request</code>
            </td>
            <td>
                  <code><span title="django.http.HttpRequest">HttpRequest</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The incoming HTTP GET request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>review_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the review. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>HttpResponse</code></td>            <td>
                  <code><span title="django.http.HttpResponse">HttpResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendered HTML response.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span>
    <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">review_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle GET requests for peer review.</span>
<span class="sd">    Loads necessary data and renders the review template.</span>

<span class="sd">    Args:</span>
<span class="sd">        request (HttpRequest): The incoming HTTP GET request.</span>
<span class="sd">        table (str): The name of the table.</span>
<span class="sd">        review_id (int, optional): The ID of the review. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HttpResponse: Rendered HTML response.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table_obj</span> <span class="o">=</span> <span class="n">table_or_404</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
    <span class="n">topic</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span>

    <span class="c1"># review_state = PeerReview.is_finished  # TODO: Use later</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json_schema</span><span class="p">()</span>
    <span class="n">can_add</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">field_descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_field_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

    <span class="c1"># Check user permissions</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">login_models</span><span class="o">.</span><span class="n">myuser</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>  <span class="c1"># type: ignore</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">is_anonymous</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get_table_permission_level</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
        <span class="n">can_add</span> <span class="o">=</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="n">login</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">WRITE_PERM</span>

    <span class="n">oemetadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_in_category</span><span class="p">(</span>
        <span class="n">table</span><span class="p">,</span> <span class="n">oemetadata</span><span class="o">=</span><span class="n">oemetadata</span>
    <span class="p">)</span>  <span class="c1"># Generate URL for peer_review_reviewer</span>
    <span class="k">if</span> <span class="n">review_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">url_peer_review</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span>
            <span class="s2">&quot;dataedit:peer_review_reviewer&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">,</span> <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="n">opr_review</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>

        <span class="n">existing_review</span> <span class="o">=</span> <span class="p">(</span><span class="n">opr_review</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviews&quot;</span><span class="p">,</span> <span class="p">[])</span>
        <span class="n">review_finished</span> <span class="o">=</span> <span class="n">opr_review</span><span class="o">.</span><span class="n">is_finished</span>
        <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;general&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;license&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="n">process_review_data</span><span class="p">(</span>
            <span class="n">review_data</span><span class="o">=</span><span class="n">existing_review</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">url_peer_review</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span>
            <span class="s2">&quot;dataedit:peer_review_create&quot;</span><span class="p">,</span>
            <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">},</span>
        <span class="p">)</span>
        <span class="c1"># existing_review={}</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">review_finished</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">config_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;can_add&quot;</span><span class="p">:</span> <span class="n">can_add</span><span class="p">,</span>
        <span class="s2">&quot;url_peer_review&quot;</span><span class="p">:</span> <span class="n">url_peer_review</span><span class="p">,</span>
        <span class="s2">&quot;url_table&quot;</span><span class="p">:</span> <span class="n">reverse</span><span class="p">(</span><span class="s2">&quot;dataedit:view&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">}),</span>
        <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">topic</span><span class="p">,</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">,</span>
        <span class="s2">&quot;review_finished&quot;</span><span class="p">:</span> <span class="n">review_finished</span><span class="p">,</span>
        <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">context_meta</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># need this here as json.dumps breaks the template syntax access</span>
        <span class="c1"># like {{ config.table }} now you can use {{ table }}</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table</span><span class="p">,</span>
        <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span><span class="p">,</span>
        <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">config_data</span><span class="p">),</span>
        <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="s2">&quot;json_schema&quot;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">,</span>
        <span class="s2">&quot;field_descriptions_json&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">field_descriptions</span><span class="p">),</span>
        <span class="s2">&quot;state_dict&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state_dict</span><span class="p">),</span>
        <span class="s2">&quot;review_finished&quot;</span><span class="p">:</span> <span class="n">review_finished</span><span class="p">,</span>
        <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_review.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context_meta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.get_all_field_descriptions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_field_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerReviewView.get_all_field_descriptions" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Collects the field title, descriptions, examples, and badge information
for each field of the oemetadata from the JSON schema and prepares them
for further processing.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>json_schema</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The JSON schema to extract field descriptions
from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>prefix</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix for nested keys. Defaults to an
empty string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary containing field descriptions, examples, and
other information.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_field_descriptions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Collects the field title, descriptions, examples, and badge information</span>
<span class="sd">    for each field of the oemetadata from the JSON schema and prepares them</span>
<span class="sd">    for further processing.</span>

<span class="sd">    Args:</span>
<span class="sd">        json_schema (dict): The JSON schema to extract field descriptions</span>
<span class="sd">            from.</span>
<span class="sd">        prefix (str, optional): The prefix for nested keys. Defaults to an</span>
<span class="sd">            empty string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing field descriptions, examples, and</span>
<span class="sd">            other information.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">field_descriptions</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">extract_descriptions</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">field</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="n">field</span>

            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span>
                <span class="n">attr</span> <span class="ow">in</span> <span class="n">value</span>
                <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="s2">&quot;examples&quot;</span><span class="p">,</span> <span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="s2">&quot;badge&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="s2">&quot;description&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span>
                <span class="c1"># Prefer v2 &quot;examples&quot; (array) over v1 &quot;example&quot; (single value)</span>
                <span class="k">if</span> <span class="s2">&quot;examples&quot;</span> <span class="ow">in</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;examples&quot;</span><span class="p">]:</span>
                    <span class="c1"># v2: first item of the examples array</span>
                    <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;example&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;examples&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;example&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="c1"># v1 fallback</span>
                    <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;example&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;example&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;badge&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;badge&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;badge&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="n">field_descriptions</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">new_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="n">field</span>
                <span class="n">extract_descriptions</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">],</span> <span class="n">new_prefix</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;items&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="n">new_prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="n">prefix</span> <span class="k">else</span> <span class="n">field</span>
                <span class="k">if</span> <span class="s2">&quot;properties&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">]:</span>
                    <span class="n">extract_descriptions</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="s2">&quot;items&quot;</span><span class="p">][</span><span class="s2">&quot;properties&quot;</span><span class="p">],</span> <span class="n">new_prefix</span><span class="p">)</span>

    <span class="n">extract_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s2">&quot;properties&quot;</span><span class="p">],</span> <span class="n">prefix</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">field_descriptions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.load_json" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_json</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerReviewView.load_json" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Load JSON metadata from the database. If the review_id is available
then load the metadata form the peer review instance and not from the
table. This avoids changes to the metadata that is or was reviewed.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>review_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Id of a peer review in the django database</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Loaded oemetadata.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load JSON metadata from the database. If the review_id is available</span>
<span class="sd">    then load the metadata form the peer review instance and not from the</span>
<span class="sd">    table. This avoids changes to the metadata that is or was reviewed.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): The name of the table.</span>
<span class="sd">        review_id (int): Id of a peer review in the django database</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Loaded oemetadata.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">review_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_metadata_from_db</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">review_id</span><span class="p">:</span>
        <span class="n">opr</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">opr</span><span class="o">.</span><span class="n">oemetadata</span>

    <span class="k">return</span> <span class="n">metadata</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.load_json_schema" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_json_schema</span><span class="p">()</span></code>

<a href="#dataedit.views.TablePeerReviewView.load_json_schema" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Load the JSON schema used for validating metadata.</p>


<details class="note" open>
  <summary>Note</summary>
  <p>Update this method if a new oemetadata version is released.</p>
</details>

    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON schema.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_json_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the JSON schema used for validating metadata.</span>

<span class="sd">    Note:</span>
<span class="sd">        Update this method if a new oemetadata version is released.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="n">OEMETADATA_V20_SCHEMA</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.parse_keys" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parse_keys</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerReviewView.parse_keys" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Recursively parse keys from a nested dictionary or list and return them
as a list of dictionaries.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>val</code>
            </td>
            <td>
                  <code><span title="dict">dict</span> or <span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input dictionary or list to parse.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>old</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The prefix for nested keys. Defaults to an
empty string.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>list</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of dictionaries, each containing 'field' and 'value'
keys.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">parse_keys</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">old</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively parse keys from a nested dictionary or list and return them</span>
<span class="sd">    as a list of dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        val (dict or list): The input dictionary or list to parse.</span>
<span class="sd">        old (str, optional): The prefix for nested keys. Defaults to an</span>
<span class="sd">            empty string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        list: A list of dictionaries, each containing &#39;field&#39; and &#39;value&#39;</span>
<span class="sd">            keys.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">val</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">lines</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_keys</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">old</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">val</span><span class="p">:</span>
            <span class="c1"># handles empty list</span>
            <span class="n">lines</span> <span class="o">+=</span> <span class="p">[{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">old</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)}]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
                <span class="n">lines</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_keys</span><span class="p">(</span>
                    <span class="n">k</span><span class="p">,</span> <span class="n">old</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="p">)</span>  <span class="c1"># handles user value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">+=</span> <span class="p">[{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">old</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)}]</span>
    <span class="k">return</span> <span class="n">lines</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.post" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerReviewView.post" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Handle POST requests for submitting reviews by the reviewer.</p>
<p>This method:
- Creates (or saves) reviews in the PeerReview table.
- Updates the review finished attribute in the dataedit.Tables table,
    indicating that the table can be moved from the model draft topic.</p>
<p>Missing parts:
- once the opr is finished (all field reviews agreed on)
- merge field review results to metadata on table
- awarde a badge
    - is field filled in?
    - calculate the badge by comparing filled fields
      and the badges form metadata schema</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>request</code>
            </td>
            <td>
                  <code><span title="django.http.HttpRequest">HttpRequest</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The incoming HTTP POST request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>review_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the review. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>HttpResponse</code></td>            <td>
                  <code><span title="django.http.HttpResponse">HttpResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendered HTML response for the review.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="django.http.JsonResponse">JsonResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If any error occurs, a JsonResponse containing the</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>There are some missing parts in this method. Once the review process
    is finished (all field reviews agreed on), it should merge field
    review results to metadata on the table and award a badge based
    on certain criteria.</li>
<li>A notification should be sent to the user if he/she can't review tables
for which he/she is the table holder (TODO).</li>
<li>After a review is finished, the table's metadata is updated, and the table
can be moved to a different topic (TODO).</li>
</ul>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle POST requests for submitting reviews by the reviewer.</span>

<span class="sd">    This method:</span>
<span class="sd">    - Creates (or saves) reviews in the PeerReview table.</span>
<span class="sd">    - Updates the review finished attribute in the dataedit.Tables table,</span>
<span class="sd">        indicating that the table can be moved from the model draft topic.</span>

<span class="sd">    Missing parts:</span>
<span class="sd">    - once the opr is finished (all field reviews agreed on)</span>
<span class="sd">    - merge field review results to metadata on table</span>
<span class="sd">    - awarde a badge</span>
<span class="sd">        - is field filled in?</span>
<span class="sd">        - calculate the badge by comparing filled fields</span>
<span class="sd">          and the badges form metadata schema</span>

<span class="sd">    Args:</span>
<span class="sd">        request (HttpRequest): The incoming HTTP POST request.</span>
<span class="sd">        table (str): The name of the table.</span>
<span class="sd">        review_id (int, optional): The ID of the review. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HttpResponse: Rendered HTML response for the review.</span>

<span class="sd">    Raises:</span>
<span class="sd">        JsonResponse: If any error occurs, a JsonResponse containing the</span>
<span class="sd">        error message is raised.</span>

<span class="sd">    Note:</span>
<span class="sd">        - There are some missing parts in this method. Once the review process</span>
<span class="sd">            is finished (all field reviews agreed on), it should merge field</span>
<span class="sd">            review results to metadata on the table and award a badge based</span>
<span class="sd">            on certain criteria.</span>
<span class="sd">        - A notification should be sent to the user if he/she can&#39;t review tables</span>
<span class="sd">        for which he/she is the table holder (TODO).</span>
<span class="sd">        - After a review is finished, the table&#39;s metadata is updated, and the table</span>
<span class="sd">        can be moved to a different topic (TODO).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="n">table_or_404</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

    <span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">user</span><span class="p">:</span> <span class="n">login_models</span><span class="o">.</span><span class="n">myuser</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>  <span class="c1"># type: ignore</span>

    <span class="c1"># get the review data and additional application metadata</span>
    <span class="c1"># from user peer review submit/save</span>
    <span class="n">review_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">review_id</span><span class="p">:</span>
        <span class="n">contributor_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">contributor_review</span><span class="p">:</span>
            <span class="n">contributor_review_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">contributor_review</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s2">&quot;reviews&quot;</span><span class="p">,</span> <span class="p">[]</span>
            <span class="p">)</span>
            <span class="n">review_data</span><span class="p">[</span><span class="s2">&quot;reviewData&quot;</span><span class="p">][</span><span class="s2">&quot;reviews&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">contributor_review_data</span><span class="p">)</span>

    <span class="c1"># The type can be &quot;save&quot; or &quot;submit&quot; as this triggers different behavior</span>
    <span class="n">review_post_type</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewType&quot;</span><span class="p">)</span>
    <span class="c1"># The opr datamodel that includes the field review data and metadata</span>
    <span class="n">review_datamodel</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewData&quot;</span><span class="p">)</span>
    <span class="n">review_finished</span> <span class="o">=</span> <span class="n">review_datamodel</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewFinished&quot;</span><span class="p">)</span>
    <span class="c1"># TODO: Send a notification to the user that he can&#39;t review tables</span>
    <span class="c1"># he is the table holder.</span>
    <span class="k">if</span> <span class="n">review_post_type</span> <span class="o">==</span> <span class="s2">&quot;delete&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">delete_peer_review</span><span class="p">(</span><span class="n">review_id</span><span class="p">)</span>

    <span class="n">contributor</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">load_contributor</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">contributor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># ÃœberprÃ¼fen, ob ein aktiver PeerReview existiert</span>
        <span class="n">active_peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">active_peer_review</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">active_peer_review</span><span class="o">.</span><span class="n">is_finished</span><span class="p">:</span>
            <span class="c1"># Kein aktiver PeerReview vorhanden</span>
            <span class="c1"># oder der aktive PeerReview ist abgeschlossen</span>
            <span class="n">table_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="p">(</span>
                <span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">is_finished</span><span class="o">=</span><span class="n">review_finished</span><span class="p">,</span>
                <span class="n">review</span><span class="o">=</span><span class="n">review_datamodel</span><span class="p">,</span>
                <span class="n">reviewer</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                <span class="n">contributor</span><span class="o">=</span><span class="n">contributor</span><span class="p">,</span>
                <span class="n">oemetadata</span><span class="o">=</span><span class="n">load_metadata_from_db</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
            <span class="p">)</span>
            <span class="n">table_review</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">review_type</span><span class="o">=</span><span class="n">review_post_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Aktiver PeerReview ist vorhanden ... aktualisieren</span>
            <span class="n">current_review_data</span> <span class="o">=</span> <span class="n">active_peer_review</span><span class="o">.</span><span class="n">review</span>
            <span class="n">merged_review_data</span> <span class="o">=</span> <span class="n">merge_field_reviews</span><span class="p">(</span>
                <span class="n">current_json</span><span class="o">=</span><span class="n">current_review_data</span><span class="p">,</span> <span class="n">new_json</span><span class="o">=</span><span class="n">review_datamodel</span>
            <span class="p">)</span>

            <span class="c1"># Set new review values and update existing review</span>
            <span class="n">active_peer_review</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">merged_review_data</span>
            <span class="n">active_peer_review</span><span class="o">.</span><span class="n">reviewer</span> <span class="o">=</span> <span class="n">user</span>  <span class="c1"># type:ignore TODO why type warning?</span>
            <span class="n">active_peer_review</span><span class="o">.</span><span class="n">contributor</span> <span class="o">=</span> <span class="n">contributor</span>  <span class="c1"># type:ignore TODO</span>
            <span class="n">active_peer_review</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">review_type</span><span class="o">=</span><span class="n">review_post_type</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Failed to retrieve any user that identifies &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;as table holder for the current table: </span><span class="si">{</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">!&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="n">error_msg</span><span class="p">},</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

    <span class="c1"># TODO: Check for topic as reviewed finished also indicates the table</span>
    <span class="c1"># needs to be or has to be moved.</span>
    <span class="k">if</span> <span class="n">review_finished</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">review_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">review_table</span><span class="o">.</span><span class="n">set_is_reviewed</span><span class="p">()</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">review_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
        <span class="n">updated_metadata</span> <span class="o">=</span> <span class="n">recursive_update</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">review_data</span><span class="p">)</span>
        <span class="n">save_metadata_to_db</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">updated_metadata</span><span class="p">)</span>
        <span class="n">active_peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">active_peer_review</span><span class="p">:</span>
            <span class="n">updated_oemetadata</span> <span class="o">=</span> <span class="n">recursive_update</span><span class="p">(</span>
                <span class="n">active_peer_review</span><span class="o">.</span><span class="n">oemetadata</span><span class="p">,</span> <span class="n">review_data</span>
            <span class="p">)</span>
            <span class="n">active_peer_review</span><span class="o">.</span><span class="n">oemetadata</span> <span class="o">=</span> <span class="n">updated_oemetadata</span>
            <span class="n">active_peer_review</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="c1"># TODO: also update reviewFinished in review datamodel json</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_review.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerReviewView.sort_in_category" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sort_in_category</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">oemetadata</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerReviewView.sort_in_category" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Group flattened OEMetadata v2 fields into thematic buckets and attach
placeholders required by the review UI.</p>
<p>Each entry has six keys:
{
  "field": "<dot-path>",
  "label": "<display label without 'resources.\<idx>.'>",
  "value": "<current value>",
  "newValue": "",
  "reviewer_suggestion": "",
  "suggestion_comment": ""
}</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sort_in_category</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">oemetadata</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Group flattened OEMetadata v2 fields into thematic buckets and attach</span>
<span class="sd">    placeholders required by the review UI.</span>

<span class="sd">    Each entry has six keys:</span>
<span class="sd">    {</span>
<span class="sd">      &quot;field&quot;: &quot;&lt;dot-path&gt;&quot;,</span>
<span class="sd">      &quot;label&quot;: &quot;&lt;display label without &#39;resources.&lt;idx&gt;.&#39;&gt;&quot;,</span>
<span class="sd">      &quot;value&quot;: &quot;&lt;current value&gt;&quot;,</span>
<span class="sd">      &quot;newValue&quot;: &quot;&quot;,</span>
<span class="sd">      &quot;reviewer_suggestion&quot;: &quot;&quot;,</span>
<span class="sd">      &quot;suggestion_comment&quot;: &quot;&quot;</span>
<span class="sd">    }</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flattened</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_keys</span><span class="p">(</span><span class="n">oemetadata</span><span class="p">)</span>
    <span class="n">flattened</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">flattened</span> <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;resources.&quot;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="n">bucket_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;spatial&quot;</span><span class="p">:</span> <span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal&quot;</span><span class="p">:</span> <span class="s2">&quot;temporal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;sources&quot;</span><span class="p">:</span> <span class="s2">&quot;source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;licenses&quot;</span><span class="p">:</span> <span class="s2">&quot;license&quot;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">make_label</span><span class="p">(</span><span class="n">dot_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># remove leading resources.&lt;idx&gt;.</span>
        <span class="n">trimmed</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^resources\.[0-9]+\.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dot_path</span><span class="p">)</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">trimmed</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">parts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;@id&quot;</span><span class="p">,</span> <span class="s2">&quot;@type&quot;</span><span class="p">}:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">out</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">flattened</span><span class="p">:</span>
        <span class="n">raw_key</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">raw_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;resources&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">root</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">bucket</span> <span class="o">=</span> <span class="n">bucket_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot;general&quot;</span><span class="p">)</span>

        <span class="n">tmp</span><span class="p">[</span><span class="n">bucket</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">raw_key</span><span class="p">,</span>
                <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="n">make_label</span><span class="p">(</span><span class="n">raw_key</span><span class="p">),</span>
                <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">],</span>
                <span class="s2">&quot;newValue&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;reviewer_suggestion&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;suggestion_comment&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;general&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;general&quot;</span><span class="p">],</span>
        <span class="s2">&quot;spatial&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;spatial&quot;</span><span class="p">],</span>
        <span class="s2">&quot;temporal&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;temporal&quot;</span><span class="p">],</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;source&quot;</span><span class="p">],</span>
        <span class="s2">&quot;license&quot;</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">],</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="peerrreviewcontributorview">PeerRreviewContributorView<a class="headerlink" href="#peerrreviewcontributorview" title="Permanent link">#</a></h3>
<p>View for the contributor role of the Open Peer Review process.</p>


<div class="doc doc-object doc-class">



<a id="dataedit.views.TablePeerRreviewContributorView"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="dataedit.views.TablePeerReviewView" href="#dataedit.views.TablePeerReviewView">TablePeerReviewView</a></code></p>



        <p>A view handling the contributor's side of the peer review process.
This view supports rendering the review template and handling GET and
POST requests for contributor's review.</p>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>dataedit/views.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">TablePeerRreviewContributorView</span><span class="p">(</span><span class="n">TablePeerReviewView</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A view handling the contributor&#39;s side of the peer review process.</span>
<span class="sd">    This view supports rendering the review template and handling GET and</span>
<span class="sd">    POST requests for contributor&#39;s review.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle GET requests for contributor&#39;s review. Loads necessary data and</span>
<span class="sd">        renders the contributor review template.</span>

<span class="sd">        Args:</span>
<span class="sd">            request (HttpRequest): The incoming HTTP GET request.</span>
<span class="sd">            table (str): The name of the table.</span>
<span class="sd">            review_id (int): The ID of the review.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HttpResponse: Rendered HTML response for contributor review.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_obj</span> <span class="o">=</span> <span class="n">table_or_404</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

        <span class="n">can_add</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>

        <span class="n">user</span><span class="p">:</span> <span class="n">login_models</span><span class="o">.</span><span class="n">myuser</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">is_anonymous</span><span class="p">:</span>
            <span class="n">level</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get_table_permission_level</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
            <span class="n">can_add</span> <span class="o">=</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="n">login</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">WRITE_PERM</span>
        <span class="n">oemetadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_in_category</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">oemetadata</span><span class="o">=</span><span class="n">oemetadata</span><span class="p">)</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json_schema</span><span class="p">()</span>
        <span class="n">field_descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_field_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
        <span class="n">review_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">peer_review</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviews&quot;</span><span class="p">,</span> <span class="p">[])</span>

        <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;general&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
            <span class="s2">&quot;temporal&quot;</span><span class="p">,</span>
            <span class="s2">&quot;source&quot;</span><span class="p">,</span>
            <span class="s2">&quot;license&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">state_dict</span> <span class="o">=</span> <span class="n">process_review_data</span><span class="p">(</span>
            <span class="n">review_data</span><span class="o">=</span><span class="n">review_data</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span>
        <span class="p">)</span>
        <span class="n">context_meta</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;can_add&quot;</span><span class="p">:</span> <span class="n">can_add</span><span class="p">,</span>
                    <span class="s2">&quot;url_peer_review&quot;</span><span class="p">:</span> <span class="n">reverse</span><span class="p">(</span>
                        <span class="s2">&quot;dataedit:peer_review_contributor&quot;</span><span class="p">,</span>
                        <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
                            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                            <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">,</span>
                        <span class="p">},</span>
                    <span class="p">),</span>
                    <span class="s2">&quot;url_table&quot;</span><span class="p">:</span> <span class="n">reverse</span><span class="p">(</span>
                        <span class="s2">&quot;dataedit:view&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
                    <span class="p">),</span>
                    <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span><span class="p">,</span>
                    <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">),</span>
            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span><span class="p">,</span>
            <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
            <span class="s2">&quot;json_schema&quot;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">,</span>
            <span class="s2">&quot;field_descriptions_json&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">field_descriptions</span><span class="p">),</span>
            <span class="s2">&quot;state_dict&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state_dict</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_contributor.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context_meta</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle POST requests for contributor&#39;s review. Merges and updates</span>
<span class="sd">        the review data in the PeerReview table.</span>

<span class="sd">        Args:</span>
<span class="sd">            request (HttpRequest): The incoming HTTP POST request.</span>
<span class="sd">            table (str): The name of the table.</span>
<span class="sd">            review_id (int): The ID of the review.</span>

<span class="sd">        Returns:</span>
<span class="sd">            HttpResponse: Rendered HTML response for contributor review.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># table_obj = table_or_404(table=table)</span>
        <span class="c1"># TODO: why unused argument &quot;table&quot;?</span>

        <span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
            <span class="n">review_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
            <span class="n">review_post_type</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewType&quot;</span><span class="p">)</span>
            <span class="n">review_datamodel</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewData&quot;</span><span class="p">)</span>
            <span class="n">current_opr</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
            <span class="n">existing_reviews</span> <span class="o">=</span> <span class="n">current_opr</span><span class="o">.</span><span class="n">review</span>
            <span class="n">merged_review</span> <span class="o">=</span> <span class="n">merge_field_reviews</span><span class="p">(</span>
                <span class="n">current_json</span><span class="o">=</span><span class="n">existing_reviews</span><span class="p">,</span> <span class="n">new_json</span><span class="o">=</span><span class="n">review_datamodel</span>
            <span class="p">)</span>

            <span class="n">current_opr</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">merged_review</span>
            <span class="n">current_opr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">review_type</span><span class="o">=</span><span class="n">review_post_type</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_contributor.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerRreviewContributorView.get" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerRreviewContributorView.get" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Handle GET requests for contributor's review. Loads necessary data and
renders the contributor review template.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>request</code>
            </td>
            <td>
                  <code><span title="django.http.HttpRequest">HttpRequest</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The incoming HTTP GET request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>review_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the review.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>HttpResponse</code></td>            <td>
                  <code><span title="django.http.HttpResponse">HttpResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendered HTML response for contributor review.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle GET requests for contributor&#39;s review. Loads necessary data and</span>
<span class="sd">    renders the contributor review template.</span>

<span class="sd">    Args:</span>
<span class="sd">        request (HttpRequest): The incoming HTTP GET request.</span>
<span class="sd">        table (str): The name of the table.</span>
<span class="sd">        review_id (int): The ID of the review.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HttpResponse: Rendered HTML response for contributor review.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="n">table_or_404</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

    <span class="n">can_add</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>

    <span class="n">user</span><span class="p">:</span> <span class="n">login_models</span><span class="o">.</span><span class="n">myuser</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">user</span>  <span class="c1"># type: ignore</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user</span><span class="o">.</span><span class="n">is_anonymous</span><span class="p">:</span>
        <span class="n">level</span> <span class="o">=</span> <span class="n">user</span><span class="o">.</span><span class="n">get_table_permission_level</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
        <span class="n">can_add</span> <span class="o">=</span> <span class="n">level</span> <span class="o">&gt;=</span> <span class="n">login</span><span class="o">.</span><span class="n">permissions</span><span class="o">.</span><span class="n">WRITE_PERM</span>
    <span class="n">oemetadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_in_category</span><span class="p">(</span><span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">oemetadata</span><span class="o">=</span><span class="n">oemetadata</span><span class="p">)</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_json_schema</span><span class="p">()</span>
    <span class="n">field_descriptions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_field_descriptions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
    <span class="n">review_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">peer_review</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviews&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="n">categories</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;general&quot;</span><span class="p">,</span>
        <span class="s2">&quot;spatial&quot;</span><span class="p">,</span>
        <span class="s2">&quot;temporal&quot;</span><span class="p">,</span>
        <span class="s2">&quot;source&quot;</span><span class="p">,</span>
        <span class="s2">&quot;license&quot;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">state_dict</span> <span class="o">=</span> <span class="n">process_review_data</span><span class="p">(</span>
        <span class="n">review_data</span><span class="o">=</span><span class="n">review_data</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span> <span class="n">categories</span><span class="o">=</span><span class="n">categories</span>
    <span class="p">)</span>
    <span class="n">context_meta</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;can_add&quot;</span><span class="p">:</span> <span class="n">can_add</span><span class="p">,</span>
                <span class="s2">&quot;url_peer_review&quot;</span><span class="p">:</span> <span class="n">reverse</span><span class="p">(</span>
                    <span class="s2">&quot;dataedit:peer_review_contributor&quot;</span><span class="p">,</span>
                    <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span>
                        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="s2">&quot;review_id&quot;</span><span class="p">:</span> <span class="n">review_id</span><span class="p">,</span>
                    <span class="p">},</span>
                <span class="p">),</span>
                <span class="s2">&quot;url_table&quot;</span><span class="p">:</span> <span class="n">reverse</span><span class="p">(</span>
                    <span class="s2">&quot;dataedit:view&quot;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
                <span class="p">),</span>
                <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span><span class="p">,</span>
                <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">),</span>
        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="s2">&quot;topic&quot;</span><span class="p">:</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">topics</span><span class="p">,</span>
        <span class="s2">&quot;meta&quot;</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span>
        <span class="s2">&quot;json_schema&quot;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">,</span>
        <span class="s2">&quot;field_descriptions_json&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">field_descriptions</span><span class="p">),</span>
        <span class="s2">&quot;state_dict&quot;</span><span class="p">:</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">state_dict</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_contributor.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context_meta</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.views.TablePeerRreviewContributorView.post" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">review_id</span><span class="p">)</span></code>

<a href="#dataedit.views.TablePeerRreviewContributorView.post" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Handle POST requests for contributor's review. Merges and updates
the review data in the PeerReview table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>request</code>
            </td>
            <td>
                  <code><span title="django.http.HttpRequest">HttpRequest</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The incoming HTTP POST request.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>review_id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The ID of the review.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>HttpResponse</code></td>            <td>
                  <code><span title="django.http.HttpResponse">HttpResponse</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Rendered HTML response for contributor review.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/views.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">HttpRequest</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">review_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HttpResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handle POST requests for contributor&#39;s review. Merges and updates</span>
<span class="sd">    the review data in the PeerReview table.</span>

<span class="sd">    Args:</span>
<span class="sd">        request (HttpRequest): The incoming HTTP POST request.</span>
<span class="sd">        table (str): The name of the table.</span>
<span class="sd">        review_id (int): The ID of the review.</span>

<span class="sd">    Returns:</span>
<span class="sd">        HttpResponse: Rendered HTML response for contributor review.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># table_obj = table_or_404(table=table)</span>
    <span class="c1"># TODO: why unused argument &quot;table&quot;?</span>

    <span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;POST&quot;</span><span class="p">:</span>
        <span class="n">review_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">body</span><span class="p">)</span>
        <span class="n">review_post_type</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewType&quot;</span><span class="p">)</span>
        <span class="n">review_datamodel</span> <span class="o">=</span> <span class="n">review_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reviewData&quot;</span><span class="p">)</span>
        <span class="n">current_opr</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span>
        <span class="n">existing_reviews</span> <span class="o">=</span> <span class="n">current_opr</span><span class="o">.</span><span class="n">review</span>
        <span class="n">merged_review</span> <span class="o">=</span> <span class="n">merge_field_reviews</span><span class="p">(</span>
            <span class="n">current_json</span><span class="o">=</span><span class="n">existing_reviews</span><span class="p">,</span> <span class="n">new_json</span><span class="o">=</span><span class="n">review_datamodel</span>
        <span class="p">)</span>

        <span class="n">current_opr</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">merged_review</span>
        <span class="n">current_opr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">review_type</span><span class="o">=</span><span class="n">review_post_type</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s2">&quot;dataedit/opr_contributor.html&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="helper-functions">Helper Functions<a class="headerlink" href="#helper-functions" title="Permanent link">#</a></h2>
<p>Separated functionality that can be imported in other modules. It contains
several functions that help with recurring tasks in the peer review system.</p>


<div class="doc doc-object doc-module">



<a id="dataedit.helper"></a>
    <div class="doc doc-contents first">

        <p>Provide helper functionality for views to reduce code lines in views.py
make the codebase more modular.</p>
<p>SPDX-FileCopyrightText: 2025 Christian Winger <a href="https://github.com/wingechr">https://github.com/wingechr</a> Â© Ã–ko-Institut e.V.
SPDX-FileCopyrightText: 2025 Daryna Barabanova <a href="https://github.com/Darynarli">https://github.com/Darynarli</a> Â© Reiner Lemoine Institut
SPDX-FileCopyrightText: 2025 Jonas Huber <a href="https://github.com/jh-RLI">https://github.com/jh-RLI</a> Â© Reiner Lemoine Institut
SPDX-FileCopyrightText: 2025 Jonas Huber <a href="https://github.com/jh-RLI">https://github.com/jh-RLI</a> Â© Reiner Lemoine Institut
SPDX-FileCopyrightText: 2025 Jonas Huber <a href="https://github.com/jh-RLI">https://github.com/jh-RLI</a> Â© Reiner Lemoine Institut
SPDX-FileCopyrightText: 2025 user <a href="https://github.com/Darynarli">https://github.com/Darynarli</a> Â© Reiner Lemoine Institut
SPDX-License-Identifier: AGPL-3.0-or-later</p>










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.add_tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_tag</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></code>

<a href="#dataedit.helper.add_tag" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>max 40 character tag text</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>hexadecimal color code, eg #aaf0f0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_tag</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        name(str): max 40 character tag text</span>
<span class="sd">        color(str): hexadecimal color code, eg #aaf0f0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Tag</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">Tag</span><span class="o">.</span><span class="n">color_from_hex</span><span class="p">(</span><span class="n">color</span><span class="p">))</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.change_requests" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">change_requests</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span></code>

<a href="#dataedit.helper.change_requests" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Loads the dataedit admin interface
:param request:
:return:</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">change_requests</span><span class="p">(</span><span class="n">table_obj</span><span class="p">:</span> <span class="n">Table</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Loads the dataedit admin interface</span>
<span class="sd">    :param request:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># I want to display old and new data, if different.</span>

    <span class="n">display_message</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">api_columns</span> <span class="o">=</span> <span class="n">get_column_changes</span><span class="p">(</span><span class="n">reviewed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">table_obj</span><span class="o">=</span><span class="n">table_obj</span><span class="p">)</span>
    <span class="n">api_constraints</span> <span class="o">=</span> <span class="n">get_constraints_changes</span><span class="p">(</span><span class="n">reviewed</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">table_obj</span><span class="o">=</span><span class="n">table_obj</span><span class="p">)</span>

    <span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_constraints&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">keyword_whitelist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;column_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;c_table&quot;</span><span class="p">,</span>
        <span class="s2">&quot;c_schema&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reviewed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;changed&quot;</span><span class="p">,</span>
        <span class="s2">&quot;id&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">old_description</span> <span class="o">=</span> <span class="n">describe_columns</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">api_columns</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;column_name&quot;</span><span class="p">]</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

        <span class="c1"># Identifing over &#39;new&#39;.</span>
        <span class="k">if</span> <span class="n">change</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;new_name&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">change</span><span class="p">[</span><span class="s2">&quot;column_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="s2">&quot;new_name&quot;</span><span class="p">]</span>

        <span class="n">old_cd</span> <span class="o">=</span> <span class="n">old_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;old&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">old_cd</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">old</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_scolumnd_from_columnd</span><span class="p">(</span>
                <span class="n">table_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">old_description</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">change</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">change</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">keyword_whitelist</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="n">old</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="n">old</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                    <span class="n">change</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;old&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">old</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;old&quot;</span><span class="p">][</span><span class="s2">&quot;c_schema&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">oedb_schema</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;old&quot;</span><span class="p">][</span><span class="s2">&quot;c_table&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;old&quot;</span><span class="p">][</span><span class="s2">&quot;column_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_columns&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s2">&quot;new&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">change</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">api_constraints</span><span class="p">)):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">api_constraints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reference_table&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="n">value</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reference_column&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="n">value</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;reference_table&quot;</span><span class="p">)</span>
            <span class="n">value</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;reference_column&quot;</span><span class="p">)</span>

        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;api_constraints&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="n">display_style</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;c_schema&quot;</span><span class="p">,</span>
        <span class="s2">&quot;c_table&quot;</span><span class="p">,</span>
        <span class="s2">&quot;column_name&quot;</span><span class="p">,</span>
        <span class="s2">&quot;not_null&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reference_table&quot;</span><span class="p">,</span>
        <span class="s2">&quot;constraint_parameter&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reference_column&quot;</span><span class="p">,</span>
        <span class="s2">&quot;action&quot;</span><span class="p">,</span>
        <span class="s2">&quot;constraint_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;constraint_name&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
        <span class="s2">&quot;display_items&quot;</span><span class="p">:</span> <span class="n">display_style</span><span class="p">,</span>
        <span class="s2">&quot;display_message&quot;</span><span class="p">:</span> <span class="n">display_message</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.delete_peer_review" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_peer_review</span><span class="p">(</span><span class="n">review_id</span><span class="p">)</span></code>

<a href="#dataedit.helper.delete_peer_review" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Remove Peer Review by review_id.
Args:
    review_id (int): ID review.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>JsonResponse</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>JSON response about successful deletion or error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete_peer_review</span><span class="p">(</span><span class="n">review_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove Peer Review by review_id.</span>
<span class="sd">    Args:</span>
<span class="sd">        review_id (int): ID review.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonResponse: JSON response about successful deletion or error.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">review_id</span><span class="p">:</span>
        <span class="n">peer_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">review_id</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">peer_review</span><span class="p">:</span>
            <span class="n">peer_review</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;PeerReview successfully deleted.&quot;</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;PeerReview not found.&quot;</span><span class="p">},</span> <span class="n">status</span><span class="o">=</span><span class="mi">404</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">JsonResponse</span><span class="p">({</span><span class="s2">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;Review ID is required.&quot;</span><span class="p">},</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.edit_tag" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edit_tag</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span></code>

<a href="#dataedit.helper.edit_tag" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>id</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tag id</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>max 40 character tag text</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>color</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>hexadecimal color code, eg #aaf0f0</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">edit_tag</span><span class="p">(</span><span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        id(int): tag id</span>
<span class="sd">        name(str): max 40 character tag text</span>
<span class="sd">        color(str): hexadecimal color code, eg #aaf0f0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">Tag</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">tag</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">tag</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">Tag</span><span class="o">.</span><span class="n">color_from_hex</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">tag</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.find_tables" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_tables</span><span class="p">(</span><span class="n">topic_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">query_string</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tag_ids</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dataedit.helper.find_tables" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>find tables given search criteria</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>topic_name</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>only tables in this topic</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>query_string</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>user search term</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tag_ids</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of tag ids</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="django.db.models.QuerySet">QuerySet</span>[<span title="dataedit.models.Table">Table</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>QuerySet of Table objetcs</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_tables</span><span class="p">(</span>
    <span class="n">topic_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">query_string</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tag_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuerySet</span><span class="p">[</span><span class="n">Table</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;find tables given search criteria</span>

<span class="sd">    Args:</span>
<span class="sd">        topic_name (str, optional): only tables in this topic</span>
<span class="sd">        query_string (str, optional): user search term</span>
<span class="sd">        tag_ids (list, optional): list of tag ids</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuerySet of Table objetcs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">tables</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">objects</span>

    <span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">is_sandbox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">topic_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">topic_name</span> <span class="o">==</span> <span class="n">PSEUDO_TOPIC_DRAFT</span><span class="p">:</span>
            <span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">is_publish</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">topics__pk</span><span class="o">=</span><span class="n">topic_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">query_string</span><span class="p">:</span>  <span class="c1"># filter by search terms</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">Q</span><span class="p">(</span>
                <span class="n">search</span><span class="o">=</span><span class="n">SearchQuery</span><span class="p">(</span>
                    <span class="s2">&quot; &amp; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">p</span> <span class="o">+</span> <span class="s2">&quot;:*&quot;</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;[\w]+&quot;</span><span class="p">,</span> <span class="n">query_string</span><span class="p">)),</span>
                    <span class="n">search_type</span><span class="o">=</span><span class="s2">&quot;raw&quot;</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">tag_ids</span><span class="p">:</span>  <span class="c1"># filter by tags:</span>
        <span class="c1"># find tables that use all of the tags</span>
        <span class="c1"># by adding a filter for each tag</span>
        <span class="c1"># (instead of all at once, which would be OR)</span>
        <span class="k">for</span> <span class="n">tag_id</span> <span class="ow">in</span> <span class="n">tag_ids</span><span class="p">:</span>
            <span class="n">tables</span> <span class="o">=</span> <span class="n">tables</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">tags__pk</span><span class="o">=</span><span class="n">tag_id</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tables</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.get_all_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_all_tags</span><span class="p">(</span><span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#dataedit.helper.get_all_tags" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Load all tags of a specific table
:param table: Name of a table
:return:</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_all_tags</span><span class="p">(</span><span class="n">table_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuerySet</span><span class="p">[</span><span class="n">Tag</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load all tags of a specific table</span>
<span class="sd">    :param table: Name of a table</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">table_name</span><span class="p">:</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table_name</span><span class="p">)</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">Tag</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">tags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.get_column_description" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_column_description</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span></code>

<a href="#dataedit.helper.get_column_description" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Return list of column descriptions:
[{
   "name": str,
   "data_type": str,
   "is_nullable': bool,
   "is_pk": bool
}]</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_column_description</span><span class="p">(</span><span class="n">table_obj</span><span class="p">:</span> <span class="n">Table</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return list of column descriptions:</span>
<span class="sd">    [{</span>
<span class="sd">       &quot;name&quot;: str,</span>
<span class="sd">       &quot;data_type&quot;: str,</span>
<span class="sd">       &quot;is_nullable&#39;: bool,</span>
<span class="sd">       &quot;is_pk&quot;: bool</span>
<span class="sd">    }]</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_datatype_str</span><span class="p">(</span><span class="n">column_def</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get single string sql type definition.</span>

<span class="sd">        We want the data type definition to be a simple string, e.g. decimal(10, 6)</span>
<span class="sd">        or varchar(128), so we need to combine the various fields</span>
<span class="sd">        (type, numeric_precision, numeric_scale, ...)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># for reverse validation, see also api.parser.parse_type(dt_string)</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">column_def</span><span class="p">[</span><span class="s2">&quot;data_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">precisions</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">dt</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;character&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">dt</span> <span class="o">==</span> <span class="s2">&quot;character varying&quot;</span><span class="p">:</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="s2">&quot;varchar&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="s2">&quot;char&quot;</span>
            <span class="n">precisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_def</span><span class="p">[</span><span class="s2">&quot;character_maximum_length&quot;</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">dt</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot; without time zone&quot;</span><span class="p">):</span>  <span class="c1"># this is the default</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; without time zone&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;(numeric|decimal)&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
            <span class="n">precisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_def</span><span class="p">[</span><span class="s2">&quot;numeric_precision&quot;</span><span class="p">],</span> <span class="n">column_def</span><span class="p">[</span><span class="s2">&quot;numeric_scale&quot;</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">dt</span> <span class="o">==</span> <span class="s2">&quot;interval&quot;</span><span class="p">:</span>
            <span class="n">precisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_def</span><span class="p">[</span><span class="s2">&quot;interval_precision&quot;</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;.*int&quot;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
            <span class="s2">&quot;nextval&quot;</span><span class="p">,</span> <span class="n">column_def</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;column_default&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
        <span class="p">):</span>
            <span class="c1"># dt = dt.replace(&#39;int&#39;, &#39;serial&#39;)</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">dt</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">):</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="s2">&quot;float&quot;</span>
        <span class="k">if</span> <span class="n">precisions</span><span class="p">:</span>  <span class="c1"># remove None</span>
            <span class="n">precisions</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">precisions</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">precisions</span><span class="p">:</span>
            <span class="n">dt</span> <span class="o">+=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">precisions</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dt</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_pk_fields</span><span class="p">(</span><span class="n">constraints</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the column names that make up the primary key</span>
<span class="sd">        from the constraints definitions.</span>

<span class="sd">        NOTE: Currently, the wizard to create tables only supports</span>
<span class="sd">            single fields primary keys (which is advisable anyways)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pk_fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_name</span><span class="p">,</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="n">constraints</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">constraint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;constraint_type&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;PRIMARY KEY&quot;</span><span class="p">:</span>
                <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span>
                    <span class="sa">r</span><span class="s2">&quot;PRIMARY KEY[ ]*\(([^)]+)&quot;</span><span class="p">,</span> <span class="n">constraint</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;definition&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
                    <span class="c1"># &quot;f1, f2&quot; -&gt; [&quot;f1&quot;, &quot;f2&quot;]</span>
                    <span class="n">pk_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">pk_fields</span>

    <span class="n">_columns</span> <span class="o">=</span> <span class="n">describe_columns</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
    <span class="n">_constraints</span> <span class="o">=</span> <span class="n">describe_constraints</span><span class="p">(</span><span class="n">table_obj</span><span class="p">)</span>
    <span class="n">pk_fields</span> <span class="o">=</span> <span class="n">get_pk_fields</span><span class="p">(</span><span class="n">_constraints</span><span class="p">)</span>
    <span class="c1"># order by ordinal_position</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="n">_columns</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">kv</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;ordinal_position&quot;</span><span class="p">])</span>
    <span class="p">):</span>
        <span class="n">columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                <span class="s2">&quot;data_type&quot;</span><span class="p">:</span> <span class="n">get_datatype_str</span><span class="p">(</span><span class="n">col</span><span class="p">),</span>
                <span class="s2">&quot;is_nullable&quot;</span><span class="p">:</span> <span class="n">col</span><span class="p">[</span><span class="s2">&quot;is_nullable&quot;</span><span class="p">],</span>
                <span class="s2">&quot;is_pk&quot;</span><span class="p">:</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">pk_fields</span><span class="p">,</span>
                <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">columns</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.get_review_for_key" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_review_for_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">review_data</span><span class="p">)</span></code>

<a href="#dataedit.helper.get_review_for_key" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Retrieve the review for a specific key from the review data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>key</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The key for which to retrieve the review.
review_data (dict): The review data containing
reviews for various keys.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new value associated with the specified key
in the review data, or None if the key is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_review_for_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">review_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve the review for a specific key from the review data.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (str): The key for which to retrieve the review.</span>
<span class="sd">            review_data (dict): The review data containing</span>
<span class="sd">            reviews for various keys.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The new value associated with the specified key</span>
<span class="sd">            in the review data, or None if the key is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">review</span> <span class="ow">in</span> <span class="n">review_data</span><span class="p">[</span><span class="s2">&quot;reviewData&quot;</span><span class="p">][</span><span class="s2">&quot;reviews&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">review</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;newValue&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.merge_field_reviews" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">merge_field_reviews</span><span class="p">(</span><span class="n">current_json</span><span class="p">,</span> <span class="n">new_json</span><span class="p">)</span></code>

<a href="#dataedit.helper.merge_field_reviews" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Merge reviews from contributors and reviewers into a single JSON object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>current_json</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current JSON object containing
reviewer's reviews.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_json</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new JSON object containing contributor's reviews.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The merged JSON object containing both contributor's and
reviewer's reviews.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>If the same key is present in both the contributor's and
    reviewer's reviews, the function will merge the field
    evaluations. Otherwise, it will create a new entry in
    the Review-Dict.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_field_reviews</span><span class="p">(</span><span class="n">current_json</span><span class="p">,</span> <span class="n">new_json</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merge reviews from contributors and reviewers into a single JSON object.</span>

<span class="sd">    Args:</span>
<span class="sd">        current_json (dict): The current JSON object containing</span>
<span class="sd">            reviewer&#39;s reviews.</span>
<span class="sd">        new_json (dict): The new JSON object containing contributor&#39;s reviews.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The merged JSON object containing both contributor&#39;s and</span>
<span class="sd">            reviewer&#39;s reviews.</span>

<span class="sd">    Note:</span>
<span class="sd">        If the same key is present in both the contributor&#39;s and</span>
<span class="sd">            reviewer&#39;s reviews, the function will merge the field</span>
<span class="sd">            evaluations. Otherwise, it will create a new entry in</span>
<span class="sd">            the Review-Dict.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">merged_json</span> <span class="o">=</span> <span class="n">new_json</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">review_dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">contrib_review</span> <span class="ow">in</span> <span class="n">merged_json</span><span class="p">[</span><span class="s2">&quot;reviews&quot;</span><span class="p">]:</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">contrib_review</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">contrib_review</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>
        <span class="n">review_dict</span><span class="p">[(</span><span class="n">category</span><span class="p">,</span> <span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">contrib_review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">reviewer_review</span> <span class="ow">in</span> <span class="n">current_json</span><span class="p">[</span><span class="s2">&quot;reviews&quot;</span><span class="p">]:</span>
        <span class="n">category</span> <span class="o">=</span> <span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span> <span class="ow">in</span> <span class="n">review_dict</span><span class="p">:</span>
            <span class="c1"># Add field evaluations to the existing entry</span>
            <span class="n">existing_field_review</span> <span class="o">=</span> <span class="n">review_dict</span><span class="p">[(</span><span class="n">category</span><span class="p">,</span> <span class="n">key</span><span class="p">)]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">existing_field_review</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">existing_field_review</span> <span class="o">=</span> <span class="p">[</span><span class="n">existing_field_review</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">]]</span>
            <span class="n">merged_field_review</span> <span class="o">=</span> <span class="n">existing_field_review</span> <span class="o">+</span> <span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">]</span>
            <span class="n">review_dict</span><span class="p">[(</span><span class="n">category</span><span class="p">,</span> <span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">merged_field_review</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Create new entry in Review-Dict</span>
            <span class="n">review_dict</span><span class="p">[(</span><span class="n">category</span><span class="p">,</span> <span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="n">reviewer_review</span><span class="p">[</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">]</span>

    <span class="c1"># Insert updated field scores back into the JSON</span>
    <span class="n">merged_json</span><span class="p">[</span><span class="s2">&quot;reviews&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="n">category</span><span class="p">,</span> <span class="s2">&quot;key&quot;</span><span class="p">:</span> <span class="n">key</span><span class="p">,</span> <span class="s2">&quot;fieldReview&quot;</span><span class="p">:</span> <span class="n">review_dict</span><span class="p">[(</span><span class="n">category</span><span class="p">,</span> <span class="n">key</span><span class="p">)]}</span>
        <span class="k">for</span> <span class="n">category</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">review_dict</span>
    <span class="p">]</span>

    <span class="k">return</span> <span class="n">merged_json</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.recursive_update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">recursive_update</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">review_data</span><span class="p">)</span></code>

<a href="#dataedit.helper.recursive_update" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Recursively updates metadata with new values from review_data,
skipping or removing fields with status 'rejected'.</p>
<p>Args:
metadata (dict): The original metadata dictionary to update.
review_data (dict): The review data containing the new values
for various keys.</p>
<p>Note:
The function iterates through the review data and for each key
updates the corresponding value in metadata if the new value is
present and is not an empty string, and if the field status is
not 'rejected'.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">recursive_update</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">review_data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recursively updates metadata with new values from review_data,</span>
<span class="sd">    skipping or removing fields with status &#39;rejected&#39;.</span>

<span class="sd">    Args:</span>
<span class="sd">    metadata (dict): The original metadata dictionary to update.</span>
<span class="sd">    review_data (dict): The review data containing the new values</span>
<span class="sd">    for various keys.</span>

<span class="sd">    Note:</span>
<span class="sd">    The function iterates through the review data and for each key</span>
<span class="sd">    updates the corresponding value in metadata if the new value is</span>
<span class="sd">    present and is not an empty string, and if the field status is</span>
<span class="sd">    not &#39;rejected&#39;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete_nested_field</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes a nested field from a dictionary based on a list of keys.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (dict or list): The dictionary or list from which</span>
<span class="sd">            to remove the field.</span>
<span class="sd">            keys (list): A list of keys pointing to the field to remove.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

        <span class="n">last_key</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="n">last_key</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_key</span><span class="p">)</span>
            <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">last_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">review_key</span> <span class="ow">in</span> <span class="n">review_data</span><span class="p">[</span><span class="s2">&quot;reviewData&quot;</span><span class="p">][</span><span class="s2">&quot;reviews&quot;</span><span class="p">]:</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">review_key</span><span class="p">[</span><span class="s2">&quot;key&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

        <span class="n">field_review</span> <span class="o">=</span> <span class="n">review_key</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;fieldReview&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_review</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">field_rejected</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="n">field_review</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;rejected&quot;</span><span class="p">:</span>
                    <span class="c1"># If a field is rejected, delete it and move on to the next one.</span>
                    <span class="n">delete_nested_field</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
                    <span class="n">field_rejected</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="n">field_rejected</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="c1"># If the field is not rejected, apply the new value</span>
            <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="n">field_review</span><span class="p">:</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="n">fr</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;newValue&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">new_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="n">set_nested_value</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">new_value</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field_review</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">field_review</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">state</span> <span class="o">==</span> <span class="s2">&quot;rejected&quot;</span><span class="p">:</span>
                <span class="c1"># If a field is rejected, delete it and move on to the next one.</span>
                <span class="n">delete_nested_field</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1"># If the field is not rejected, apply the new value</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="n">field_review</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;newValue&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_value</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">set_nested_value</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">new_value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">metadata</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.set_nested_value" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_nested_value</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></code>

<a href="#dataedit.helper.set_nested_value" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>Set a nested value in a dictionary given a sequence of keys.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dictionary in which to set the value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>keys</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of keys representing the path to the nested value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><span title="Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to set.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The function navigates through the dictionary using the keys
and sets the value at the position indicated by the last key in the list.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_nested_value</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set a nested value in a dictionary given a sequence of keys.</span>

<span class="sd">    Args:</span>
<span class="sd">        metadata (dict): The dictionary in which to set the value.</span>
<span class="sd">        keys (list): A list of keys representing the path to the nested value.</span>
<span class="sd">        value (Any): The value to set.</span>

<span class="sd">    Note:</span>
<span class="sd">        The function navigates through the dictionary using the keys</span>
<span class="sd">        and sets the value at the position indicated by the last key in the list.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">last_key</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">last_key</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
        <span class="n">last_key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">last_key</span><span class="p">)</span>
    <span class="n">metadata</span><span class="p">[</span><span class="n">last_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="dataedit.helper.update_keywords_from_tags" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_keywords_from_tags</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>

<a href="#dataedit.helper.update_keywords_from_tags" class="headerlink" title="Permanent link">#</a></h3>


    <div class="doc doc-contents ">

        <p>synchronize keywords in metadata with tags</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/helper.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_keywords_from_tags</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="n">Table</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;synchronize keywords in metadata with tags&quot;&quot;&quot;</span>

    <span class="n">metadata</span> <span class="o">=</span> <span class="n">load_metadata_from_db</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="n">keywords</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">name_normalized</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">tags</span><span class="o">.</span><span class="n">all</span><span class="p">()]</span>
    <span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;resources&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;keywords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">keywords</span>

    <span class="n">set_table_metadata</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="metadata-functions">Metadata Functions<a class="headerlink" href="#metadata-functions" title="Permanent link">#</a></h2>
<p>Provide functionality that is related to retrieving and updating the oemetadata
resource from the database. The oemetadata is the object of a review.</p>
<h3 id="save-metadata-to-database">Save Metadata to Database<a class="headerlink" href="#save-metadata-to-database" title="Permanent link">#</a></h3>


<div class="doc doc-object doc-function">



<a id="dataedit.metadata.save_metadata_to_db"></a>
    <div class="doc doc-contents first">

        <p>Save updated metadata for a specific table in the OEP database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table in the OEP.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>updated_metadata</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated metadata dictionary.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>This function loads the table object from the database,
updates its metadata field, and then saves the updated
table object back to the database.</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/metadata/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save_metadata_to_db</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">updated_metadata</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save updated metadata for a specific table in the OEP database.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): The name of the table in the OEP.</span>
<span class="sd">        updated_metadata (dict): The updated metadata dictionary.</span>

<span class="sd">    Note:</span>
<span class="sd">        This function loads the table object from the database,</span>
<span class="sd">        updates its metadata field, and then saves the updated</span>
<span class="sd">        table object back to the database.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Load the table object</span>
    <span class="n">table_obj</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

    <span class="c1"># Update the oemetadata field</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">oemetadata</span> <span class="o">=</span> <span class="n">updated_metadata</span>

    <span class="c1"># Save the updated table object</span>
    <span class="n">table_obj</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h3 id="load-metadata-from-database">Load Metadata from Database<a class="headerlink" href="#load-metadata-from-database" title="Permanent link">#</a></h3>


<div class="doc doc-object doc-function">



<a id="dataedit.metadata.load_metadata_from_db"></a>
    <div class="doc doc-contents first">

        <p>Load metadata for a specific table from the OEP database.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the table in the OEP.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The loaded metadata dictionary.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="note" open>
  <summary>Note</summary>
  <p>The function currently loads metadata from the Table.oemetadata field.
There is a consideration to change this function to use a different approach
or keep the old functionality (TODO).</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/metadata/__init__.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">load_metadata_from_db</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load metadata for a specific table from the OEP database.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): The name of the table in the OEP.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: The loaded metadata dictionary.</span>

<span class="sd">    Note:</span>
<span class="sd">        The function currently loads metadata from the Table.oemetadata field.</span>
<span class="sd">        There is a consideration to change this function to use a different approach</span>
<span class="sd">        or keep the old functionality (TODO).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table_obj</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">oemetadata</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">metadata</span><span class="p">:</span>
        <span class="c1"># empty / new metadata</span>

        <span class="c1"># TODO: the template is full of empty strings, which are not valid metadata</span>
        <span class="c1"># so we use only parts of it</span>

        <span class="n">metaMetadata</span> <span class="o">=</span> <span class="n">OEMETADATA_V20_TEMPLATE</span><span class="p">[</span><span class="s2">&quot;metaMetadata&quot;</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">table_obj</span><span class="o">.</span><span class="n">name</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
            <span class="s2">&quot;resources&quot;</span><span class="p">:</span> <span class="p">[{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}],</span>
            <span class="s2">&quot;metaMetadata&quot;</span><span class="p">:</span> <span class="n">metaMetadata</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">validate_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span> <span class="n">check_license</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">metadata</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div><h2 id="models">Models<a class="headerlink" href="#models" title="Permanent link">#</a></h2>
<p>Django models.</p>
<h3 id="peerreview">PeerReview<a class="headerlink" href="#peerreview" title="Permanent link">#</a></h3>
<p>The model of the Open Peer Review defines what data is stored in the django
database about each existing review. Next to the review itself it stores
additional data about the the reviewer and contributor user and more. It is used
in the PeerReviewManger.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model also provides functionality that is directly related to the model.
It is up to discussion if we want to keep the functionality inside the model.</p>
</div>


<div class="doc doc-object doc-class">



<a id="dataedit.models.PeerReview"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="django.db.models.Model">Model</span></code></p>



        <p>Represents a peer review in the database.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.table">table</span></code></td>
            <td>
                  <code><span title="django.db.models.CharField">CharField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the table being reviewed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.reviewer">reviewer</span></code></td>
            <td>
                  <code><span title="django.db.models.ForeignKey">ForeignKey</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user who reviews.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.contributor">contributor</span></code></td>
            <td>
                  <code><span title="django.db.models.ForeignKey">ForeignKey</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The user who contributes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.is_finished">is_finished</span></code></td>
            <td>
                  <code><span title="django.db.models.BooleanField">BooleanField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the review is finished.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.date_started">date_started</span></code></td>
            <td>
                  <code><span title="django.db.models.DateTimeField">DateTimeField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When the review started.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.date_submitted">date_submitted</span></code></td>
            <td>
                  <code><span title="django.db.models.DateTimeField">DateTimeField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When the review was submitted.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.date_finished">date_finished</span></code></td>
            <td>
                  <code><span title="django.db.models.DateTimeField">DateTimeField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>When the review finished.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReview.review">review</span></code></td>
            <td>
                  <code><span title="django.db.models.JSONField">JSONField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The review data in JSON format.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>dataedit/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PeerReview</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a peer review in the database.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        table (CharField): Name of the table being reviewed.</span>
<span class="sd">        reviewer (ForeignKey): The user who reviews.</span>
<span class="sd">        contributor (ForeignKey): The user who contributes.</span>
<span class="sd">        is_finished (BooleanField): Whether the review is finished.</span>
<span class="sd">        date_started (DateTimeField): When the review started.</span>
<span class="sd">        date_submitted (DateTimeField): When the review was submitted.</span>
<span class="sd">        date_finished (DateTimeField): When the review finished.</span>
<span class="sd">        review (JSONField): The review data in JSON format.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">reviewer</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s2">&quot;login.myuser&quot;</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;reviewed_by&quot;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">contributor</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s2">&quot;login.myuser&quot;</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;review_received&quot;</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">is_finished</span> <span class="o">=</span> <span class="n">BooleanField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">date_started</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
    <span class="n">date_submitted</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">date_finished</span> <span class="o">=</span> <span class="n">DateTimeField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">JSONField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># TODO: Maybe oemetadata should be stored in a separate table and imported</span>
    <span class="c1"># via FK here / change also for Tables model</span>
    <span class="n">oemetadata</span> <span class="o">=</span> <span class="n">JSONField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="n">review_id</span><span class="p">:</span> <span class="n">QuerySet</span><span class="p">[</span><span class="s2">&quot;PeerReviewManager&quot;</span><span class="p">]</span>  <span class="c1"># related_name, for static type checking</span>
    <span class="n">prev_review</span><span class="p">:</span> <span class="n">QuerySet</span><span class="p">[</span><span class="s2">&quot;PeerReviewManager&quot;</span><span class="p">]</span>  <span class="c1"># related_name, for static type checking</span>
    <span class="n">next_review</span><span class="p">:</span> <span class="n">QuerySet</span><span class="p">[</span><span class="s2">&quot;PeerReviewManager&quot;</span><span class="p">]</span>  <span class="c1"># related_name, for static type checking</span>

    <span class="c1"># laden</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PeerReview&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the current reviewer user.</span>
<span class="sd">        The current review is review is determened by the latest date started.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (string): Table name</span>

<span class="sd">        Returns:</span>
<span class="sd">            opr (PeerReview): PeerReview object related to the latest</span>
<span class="sd">            date started.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opr</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;-date_started&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">opr</span>

    <span class="c1"># TODO: CAUTION unfinished work ... fix: includes all idÂ´s and not just the</span>
    <span class="c1"># related ones (reviews on same table) .. procedures false results</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_prev_and_next_reviews</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the prev_review and next_review fields based on the date_started</span>
<span class="sd">        field of the PeerReview objects associated with the same table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get all the PeerReview objects associated with the same table name</span>
        <span class="n">peer_reviews</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;date_started&quot;</span><span class="p">)</span>

        <span class="n">current_index</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">review</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">peer_reviews</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">review</span><span class="o">.</span><span class="n">pk</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
                <span class="n">current_index</span> <span class="o">=</span> <span class="n">index</span>
                <span class="k">break</span>

        <span class="n">prev_review</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">next_review</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">current_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">current_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prev_review</span> <span class="o">=</span> <span class="n">peer_reviews</span><span class="p">[</span><span class="n">current_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">current_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">peer_reviews</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">next_review</span> <span class="o">=</span> <span class="n">peer_reviews</span><span class="p">[</span><span class="n">current_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">prev_review</span><span class="p">,</span> <span class="n">next_review</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">review_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;review_type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">pm_new</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contributor</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reviewer</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="c1"># TODO: This causes errors if review list ist empty</span>

            <span class="k">if</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;save&quot;</span><span class="p">:</span>
                <span class="n">pm_new</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="p">(</span>
                    <span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span>
                <span class="p">)</span>

            <span class="k">elif</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_version_of_metadata_for_review</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">pm_new</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="p">(</span>
                    <span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SUBMITTED</span><span class="o">.</span><span class="n">value</span>
                <span class="p">)</span>
                <span class="n">pm_new</span><span class="o">.</span><span class="n">set_next_reviewer</span><span class="p">()</span>

            <span class="k">elif</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;finished&quot;</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_version_of_metadata_for_review</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">elif</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="n">pm_new</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="p">(</span>
                    <span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">FINISHED</span><span class="o">.</span><span class="n">value</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">date_finished</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">pm_new</span><span class="p">:</span>
                <span class="n">pm_new</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Contributor and reviewer cannot be the same.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Custom delete method to remove related PeerReviewManager entries.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Remove related records in PeerReviewManager</span>
        <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the peer review if the latest peer review is not finished yet</span>
<span class="sd">        but either saved or submitted.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">review_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;review_type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contributor</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reviewer</span><span class="p">:</span>
            <span class="n">current_pm</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;save&quot;</span><span class="p">:</span>
                <span class="n">current_pm</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span>
            <span class="k">elif</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span>
                <span class="n">current_pm</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SUBMITTED</span><span class="o">.</span><span class="n">value</span>
                <span class="n">current_pm</span><span class="o">.</span><span class="n">set_next_reviewer</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;finished&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">date_finished</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                <span class="n">current_pm</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">FINISHED</span><span class="o">.</span><span class="n">value</span>

            <span class="c1"># update peere review manager related to this peer review entry</span>
            <span class="n">current_pm</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Contributor and reviewer cannot be the same.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_version_of_metadata_for_review</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Once the peer review is started, we save the current version of the</span>
<span class="sd">        oemetadata that is present on the table to the peer review instance</span>
<span class="sd">        to be able to do the review to a fixed state of the metadata.</span>

<span class="sd">        A started review means a reviewer saves / submits or finishes (in case</span>
<span class="sd">        the review is completed in one go) a review.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): Table name</span>

<span class="sd">        Returns:</span>
<span class="sd">            State (tuple): Bool value that indicates weather there is already</span>
<span class="sd">            a version of oemetadata available for this review &amp; readable</span>
<span class="sd">            status message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_oemetdata</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">oemetadata</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oemetadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oemetadata</span> <span class="o">=</span> <span class="n">table_oemetdata</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="k">return</span> <span class="p">(</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;Set current version of table&#39;s: &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39; &quot;</span> <span class="s2">&quot;oemetadata for review.&quot;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="kc">False</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;This tables (name: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">) review &quot;</span>
            <span class="s2">&quot;already got a version of oemetadata.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_all_table_peer_reviews_after_table_moved</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">review</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">review_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">review</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">review_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">review</span> <span class="ow">or</span> <span class="p">{}</span>

        <span class="n">review_data</span><span class="p">[</span><span class="s2">&quot;topic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">topic</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">review</span> <span class="o">=</span> <span class="n">review_data</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">days_open</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_started</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># Review has not started yet</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_finished</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">date_finished</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_started</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>  <span class="c1"># Review has finished</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_started</span><span class="p">)</span><span class="o">.</span><span class="n">days</span>  <span class="c1"># Review is still open</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReview.delete" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dataedit.models.PeerReview.delete" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Custom delete method to remove related PeerReviewManager entries.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Custom delete method to remove related PeerReviewManager entries.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Remove related records in PeerReviewManager</span>
    <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReview.get_prev_and_next_reviews" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_prev_and_next_reviews</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>

<a href="#dataedit.models.PeerReview.get_prev_and_next_reviews" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Sets the prev_review and next_review fields based on the date_started
field of the PeerReview objects associated with the same table.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_prev_and_next_reviews</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets the prev_review and next_review fields based on the date_started</span>
<span class="sd">    field of the PeerReview objects associated with the same table.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get all the PeerReview objects associated with the same table name</span>
    <span class="n">peer_reviews</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;date_started&quot;</span><span class="p">)</span>

    <span class="n">current_index</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">review</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">peer_reviews</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">review</span><span class="o">.</span><span class="n">pk</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">:</span>
            <span class="n">current_index</span> <span class="o">=</span> <span class="n">index</span>
            <span class="k">break</span>

    <span class="n">prev_review</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">next_review</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="n">current_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">current_index</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prev_review</span> <span class="o">=</span> <span class="n">peer_reviews</span><span class="p">[</span><span class="n">current_index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">current_index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">peer_reviews</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">next_review</span> <span class="o">=</span> <span class="n">peer_reviews</span><span class="p">[</span><span class="n">current_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">prev_review</span><span class="p">,</span> <span class="n">next_review</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReview.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReview.load" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Load the current reviewer user.
The current review is review is determened by the latest date started.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="string">string</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>opr</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="dataedit.models.PeerReview" href="#dataedit.models.PeerReview">PeerReview</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PeerReview object related to the latest</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="dataedit.models.PeerReview" href="#dataedit.models.PeerReview">PeerReview</a>, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>date started.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;PeerReview&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the current reviewer user.</span>
<span class="sd">    The current review is review is determened by the latest date started.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (string): Table name</span>

<span class="sd">    Returns:</span>
<span class="sd">        opr (PeerReview): PeerReview object related to the latest</span>
<span class="sd">        date started.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">opr</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s2">&quot;-date_started&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">opr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReview.set_version_of_metadata_for_review" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_version_of_metadata_for_review</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dataedit.models.PeerReview.set_version_of_metadata_for_review" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Once the peer review is started, we save the current version of the
oemetadata that is present on the table to the peer review instance
to be able to do the review to a fixed state of the metadata.</p>
<p>A started review means a reviewer saves / submits or finishes (in case
the review is completed in one go) a review.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>State</code></td>            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Bool value that indicates weather there is already</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a version of oemetadata available for this review &amp; readable</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>status message.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_version_of_metadata_for_review</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Once the peer review is started, we save the current version of the</span>
<span class="sd">    oemetadata that is present on the table to the peer review instance</span>
<span class="sd">    to be able to do the review to a fixed state of the metadata.</span>

<span class="sd">    A started review means a reviewer saves / submits or finishes (in case</span>
<span class="sd">    the review is completed in one go) a review.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): Table name</span>

<span class="sd">    Returns:</span>
<span class="sd">        State (tuple): Bool value that indicates weather there is already</span>
<span class="sd">        a version of oemetadata available for this review &amp; readable</span>
<span class="sd">        status message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">table_oemetdata</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table</span><span class="p">)</span><span class="o">.</span><span class="n">oemetadata</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oemetadata</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oemetadata</span> <span class="o">=</span> <span class="n">table_oemetdata</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="kc">True</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;Set current version of table&#39;s: &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39; &quot;</span> <span class="s2">&quot;oemetadata for review.&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="kc">False</span><span class="p">,</span>
        <span class="sa">f</span><span class="s2">&quot;This tables (name: </span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">) review &quot;</span>
        <span class="s2">&quot;already got a version of oemetadata.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReview.update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dataedit.models.PeerReview.update" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Update the peer review if the latest peer review is not finished yet
but either saved or submitted.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the peer review if the latest peer review is not finished yet</span>
<span class="sd">    but either saved or submitted.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">review_type</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;review_type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">contributor</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">reviewer</span><span class="p">:</span>
        <span class="n">current_pm</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;save&quot;</span><span class="p">:</span>
            <span class="n">current_pm</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span>
        <span class="k">elif</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;submit&quot;</span><span class="p">:</span>
            <span class="n">current_pm</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SUBMITTED</span><span class="o">.</span><span class="n">value</span>
            <span class="n">current_pm</span><span class="o">.</span><span class="n">set_next_reviewer</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">review_type</span> <span class="o">==</span> <span class="s2">&quot;finished&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_finished</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">date_finished</span> <span class="o">=</span> <span class="n">timezone</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="n">current_pm</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">FINISHED</span><span class="o">.</span><span class="n">value</span>

        <span class="c1"># update peere review manager related to this peer review entry</span>
        <span class="n">current_pm</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">ValidationError</span><span class="p">(</span><span class="s2">&quot;Contributor and reviewer cannot be the same.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="peerreviewmanager">PeerReviewManager<a class="headerlink" href="#peerreviewmanager" title="Permanent link">#</a></h3>
<p>The Manager is introduced to be able to store additional information about the
peer review process and separate it from the PeerReview model. The process is
started by submitting a review and the manager maintains the order of which user
has to take the next action to be able to hold and activate the process.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This model also provides functionality that is directly related to the model.
It is up to discussion if we want to keep the functionality inside the model.</p>
</div>


<div class="doc doc-object doc-class">



<a id="dataedit.models.PeerReviewManager"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><span title="django.db.models.Model">Model</span></code></p>



        <p>Manages peer review processes.</p>
<p>This model handles the 1:n relation between table and open peer reviews.
It tracks the days open for the peer review and its state.
It determines who is next in the process between reviewer and contributor.
It provides information about the previous and next review.
It offers several methods that provide generic filters for the peer reviews.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReviewManager.opr">opr</span></code></td>
            <td>
                  <code><span title="django.db.models.ForeignKey">ForeignKey</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The associated peer review.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReviewManager.current_reviewer">current_reviewer</span></code></td>
            <td>
                  <code><span title="django.db.models.CharField">CharField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current reviewer.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReviewManager.status">status</span></code></td>
            <td>
                  <code><span title="django.db.models.CharField">CharField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The current status of the review.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReviewManager.is_open_since">is_open_since</span></code></td>
            <td>
                  <code><span title="django.db.models.CharField">CharField</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>How long the review has been open.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReviewManager.prev_review">prev_review</span></code></td>
            <td>
                  <code><span title="django.db.models.ForeignKey">ForeignKey</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The previous review in the process.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="dataedit.models.PeerReviewManager.next_review">next_review</span></code></td>
            <td>
                  <code><span title="django.db.models.ForeignKey">ForeignKey</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The next review in the process.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>dataedit/models.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">PeerReviewManager</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manages peer review processes.</span>

<span class="sd">    This model handles the 1:n relation between table and open peer reviews.</span>
<span class="sd">    It tracks the days open for the peer review and its state.</span>
<span class="sd">    It determines who is next in the process between reviewer and contributor.</span>
<span class="sd">    It provides information about the previous and next review.</span>
<span class="sd">    It offers several methods that provide generic filters for the peer reviews.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        opr (ForeignKey): The associated peer review.</span>
<span class="sd">        current_reviewer (CharField): The current reviewer.</span>
<span class="sd">        status (CharField): The current status of the review.</span>
<span class="sd">        is_open_since (CharField): How long the review has been open.</span>
<span class="sd">        prev_review (ForeignKey): The previous review in the process.</span>
<span class="sd">        next_review (ForeignKey): The next review in the process.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REVIEW_STATUS</span> <span class="o">=</span> <span class="p">[(</span><span class="n">status</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">status</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">status</span> <span class="ow">in</span> <span class="n">ReviewDataStatus</span><span class="p">]</span>
    <span class="n">REVIEWER_CHOICES</span> <span class="o">=</span> <span class="p">[(</span><span class="n">choice</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">choice</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">Reviewer</span><span class="p">]</span>

    <span class="n">opr</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">PeerReview</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span> <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;review_id&quot;</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">current_reviewer</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">REVIEWER_CHOICES</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span>
    <span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span>
        <span class="n">choices</span><span class="o">=</span><span class="n">REVIEW_STATUS</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span>
    <span class="p">)</span>
    <span class="n">is_open_since</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">prev_review</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">PeerReview</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;prev_review&quot;</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>  <span class="c1"># TODO: add logic</span>
    <span class="n">next_review</span> <span class="o">=</span> <span class="n">ForeignKey</span><span class="p">(</span>
        <span class="n">PeerReview</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;next_review&quot;</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span>  <span class="c1"># TODO: add logic</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">opr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load the peer review manager associated with the given peer review.</span>

<span class="sd">        Args:</span>
<span class="sd">            opr (PeerReview): The peer review.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PeerReviewManager: The peer review manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">peer_review_manager</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="n">opr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">peer_review_manager</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override the save method to perform additional logic</span>
<span class="sd">        before saving the peer review manager.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Set is_open_since field if it is None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_open_since</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Get the associated PeerReview instance</span>
            <span class="n">peer_review</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opr</span>

            <span class="c1"># Set is_open_since based on the days_open property of the</span>
            <span class="c1"># PeerReview instance</span>
            <span class="n">days_open</span> <span class="o">=</span> <span class="n">peer_review</span><span class="o">.</span><span class="n">days_open</span>
            <span class="k">if</span> <span class="n">days_open</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_open_since</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">days_open</span><span class="p">)</span>
        <span class="c1"># Call the parent class&#39;s save method to save the PeerReviewManager instance</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_open_since</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">opr</span><span class="p">:</span> <span class="n">PeerReview</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the &quot;is_open_since&quot; field of the peer review manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            opr (PeerReview): The peer review.</span>
<span class="sd">            If None, use the peer review associated with the manager.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">opr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">peer_review_manager</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="n">opr</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">peer_review_manager</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

        <span class="n">days_open</span> <span class="o">=</span> <span class="n">peer_review_manager</span><span class="o">.</span><span class="n">opr</span><span class="o">.</span><span class="n">days_open</span>
        <span class="n">peer_review_manager</span><span class="o">.</span><span class="n">is_open_since</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">days_open</span><span class="p">)</span>

        <span class="c1"># Call the parent class&#39;s save method to save the PeerReviewManager instance</span>
        <span class="n">peer_review_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_next_reviewer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the order on which peer will be required to perform a action to</span>
<span class="sd">        continue with the process.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO:check for user identifies as ...</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">==</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">whos_turn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the user and role (contributor or reviewer) whose turn it is.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[str, User]: The role and user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">role</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="n">peer_review</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opr</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">==</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">role</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">peer_review</span><span class="o">.</span><span class="n">reviewer</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">role</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">peer_review</span><span class="o">.</span><span class="n">contributor</span>

        <span class="k">return</span> <span class="n">role</span><span class="p">,</span> <span class="n">result</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_contributor</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the contributor for the table a review is started.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): Table name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            User: The contributor user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
        <span class="n">userpermission</span> <span class="o">=</span> <span class="n">current_table</span><span class="o">.</span><span class="n">userpermission_set</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">table</span><span class="o">=</span><span class="n">current_table</span><span class="o">.</span><span class="n">pk</span>
        <span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
        <span class="n">table_holder</span> <span class="o">=</span> <span class="n">userpermission</span><span class="o">.</span><span class="n">holder</span> <span class="k">if</span> <span class="n">userpermission</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">table_holder</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load_reviewer</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the reviewer for the table a review is started.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): Table name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            User: The reviewer user.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">current_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">current_review</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">current_review</span><span class="p">,</span> <span class="s2">&quot;reviewer&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">current_review</span><span class="o">.</span><span class="n">reviewer</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_opr_by_reviewer</span><span class="p">(</span><span class="n">reviewer_user</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter peer reviews by reviewer, excluding those with current peer</span>
<span class="sd">        is contributor and the data status &quot;SAVED&quot; in the peer review manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            reviewer_user (User): The reviewer user.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuerySet: Filtered peer reviews.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">reviewer</span><span class="o">=</span><span class="n">reviewer_user</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
            <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_latest_open_opr_by_reviewer</span><span class="p">(</span><span class="n">reviewer_user</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the last open peer review for the given contributor.</span>

<span class="sd">        Args:</span>
<span class="sd">            contributor_user (User): The contributor user.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PeerReview: Last open peer review or None if not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">reviewer</span><span class="o">=</span><span class="n">reviewer_user</span><span class="p">,</span> <span class="n">is_finished</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
                    <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">latest</span><span class="p">(</span><span class="s2">&quot;date_started&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_opr_by_contributor</span><span class="p">(</span><span class="n">contributor_user</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter peer reviews by contributor, excluding those with current peer</span>
<span class="sd">        is reviewer and the data status &quot;SAVED&quot; in the peer review manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            contributor_user (User): The contributor user.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuerySet: Filtered peer reviews.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">contributor</span><span class="o">=</span><span class="n">contributor_user</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
            <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_latest_open_opr_by_contributor</span><span class="p">(</span><span class="n">contributor_user</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the last open peer review for the given contributor.</span>

<span class="sd">        Args:</span>
<span class="sd">            contributor_user (User): The contributor user.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PeerReview: Last open peer review or None if not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                    <span class="n">contributor</span><span class="o">=</span><span class="n">contributor_user</span><span class="p">,</span> <span class="n">is_finished</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
                    <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                    <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="o">.</span><span class="n">latest</span><span class="p">(</span><span class="s2">&quot;date_started&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">filter_opr_by_table</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuerySet</span><span class="p">[</span><span class="n">PeerReview</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Filter peer reviews by table.</span>

<span class="sd">        Args:</span>
<span class="sd">            table (str): Table name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            QuerySet: Filtered peer reviews.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_opr_by_id</span><span class="p">(</span><span class="n">opr_id</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PeerReview</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">opr_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.filter_latest_open_opr_by_contributor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_latest_open_opr_by_contributor</span><span class="p">(</span><span class="n">contributor_user</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.filter_latest_open_opr_by_contributor" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get the last open peer review for the given contributor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contributor_user</code>
            </td>
            <td>
                  <code><span title="User">User</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contributor user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PeerReview</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last open peer review or None if not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span>
<span class="normal">998</span>
<span class="normal">999</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_latest_open_opr_by_contributor</span><span class="p">(</span><span class="n">contributor_user</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the last open peer review for the given contributor.</span>

<span class="sd">    Args:</span>
<span class="sd">        contributor_user (User): The contributor user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PeerReview: Last open peer review or None if not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                <span class="n">contributor</span><span class="o">=</span><span class="n">contributor_user</span><span class="p">,</span> <span class="n">is_finished</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
                <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">latest</span><span class="p">(</span><span class="s2">&quot;date_started&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.filter_latest_open_opr_by_reviewer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_latest_open_opr_by_reviewer</span><span class="p">(</span><span class="n">reviewer_user</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.filter_latest_open_opr_by_reviewer" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get the last open peer review for the given contributor.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contributor_user</code>
            </td>
            <td>
                  <code><span title="User">User</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contributor user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PeerReview</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Last open peer review or None if not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_latest_open_opr_by_reviewer</span><span class="p">(</span><span class="n">reviewer_user</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the last open peer review for the given contributor.</span>

<span class="sd">    Args:</span>
<span class="sd">        contributor_user (User): The contributor user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PeerReview: Last open peer review or None if not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">reviewer</span><span class="o">=</span><span class="n">reviewer_user</span><span class="p">,</span> <span class="n">is_finished</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
                <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
                <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">.</span><span class="n">latest</span><span class="p">(</span><span class="s2">&quot;date_started&quot;</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.filter_opr_by_contributor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_opr_by_contributor</span><span class="p">(</span><span class="n">contributor_user</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.filter_opr_by_contributor" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Filter peer reviews by contributor, excluding those with current peer
is reviewer and the data status "SAVED" in the peer review manager.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>contributor_user</code>
            </td>
            <td>
                  <code><span title="User">User</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contributor user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>QuerySet</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filtered peer reviews.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_opr_by_contributor</span><span class="p">(</span><span class="n">contributor_user</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter peer reviews by contributor, excluding those with current peer</span>
<span class="sd">    is reviewer and the data status &quot;SAVED&quot; in the peer review manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        contributor_user (User): The contributor user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuerySet: Filtered peer reviews.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">contributor</span><span class="o">=</span><span class="n">contributor_user</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
        <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.filter_opr_by_reviewer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_opr_by_reviewer</span><span class="p">(</span><span class="n">reviewer_user</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.filter_opr_by_reviewer" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Filter peer reviews by reviewer, excluding those with current peer
is contributor and the data status "SAVED" in the peer review manager.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>reviewer_user</code>
            </td>
            <td>
                  <code><span title="User">User</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reviewer user.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>QuerySet</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filtered peer reviews.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_opr_by_reviewer</span><span class="p">(</span><span class="n">reviewer_user</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter peer reviews by reviewer, excluding those with current peer</span>
<span class="sd">    is contributor and the data status &quot;SAVED&quot; in the peer review manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        reviewer_user (User): The reviewer user.</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuerySet: Filtered peer reviews.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">reviewer</span><span class="o">=</span><span class="n">reviewer_user</span><span class="p">)</span><span class="o">.</span><span class="n">exclude</span><span class="p">(</span>
        <span class="n">review_id__current_reviewer</span><span class="o">=</span><span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
        <span class="n">review_id__status</span><span class="o">=</span><span class="n">ReviewDataStatus</span><span class="o">.</span><span class="n">SAVED</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.filter_opr_by_table" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">filter_opr_by_table</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.filter_opr_by_table" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Filter peer reviews by table.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>QuerySet</code></td>            <td>
                  <code><span title="django.db.models.QuerySet">QuerySet</span>[<a class="autorefs autorefs-internal" title="dataedit.models.PeerReview" href="#dataedit.models.PeerReview">PeerReview</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filtered peer reviews.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">filter_opr_by_table</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">QuerySet</span><span class="p">[</span><span class="n">PeerReview</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Filter peer reviews by table.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): Table name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        QuerySet: Filtered peer reviews.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">opr</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.load" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Load the peer review manager associated with the given peer review.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>opr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="dataedit.models.PeerReview" href="#dataedit.models.PeerReview">PeerReview</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The peer review.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>PeerReviewManager</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The peer review manager.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">opr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load the peer review manager associated with the given peer review.</span>

<span class="sd">    Args:</span>
<span class="sd">        opr (PeerReview): The peer review.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PeerReviewManager: The peer review manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">peer_review_manager</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="n">opr</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">peer_review_manager</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.load_contributor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_contributor</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.load_contributor" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get the contributor for the table a review is started.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>User</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The contributor user.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_contributor</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the contributor for the table a review is started.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): Table name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        User: The contributor user.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
    <span class="n">userpermission</span> <span class="o">=</span> <span class="n">current_table</span><span class="o">.</span><span class="n">userpermission_set</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
        <span class="n">table</span><span class="o">=</span><span class="n">current_table</span><span class="o">.</span><span class="n">pk</span>
    <span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>
    <span class="n">table_holder</span> <span class="o">=</span> <span class="n">userpermission</span><span class="o">.</span><span class="n">holder</span> <span class="k">if</span> <span class="n">userpermission</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="n">table_holder</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.load_reviewer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_reviewer</span><span class="p">(</span><span class="n">table</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.load_reviewer" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get the reviewer for the table a review is started.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>table</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Table name.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>User</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The reviewer user.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@staticmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_reviewer</span><span class="p">(</span><span class="n">table</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the reviewer for the table a review is started.</span>

<span class="sd">    Args:</span>
<span class="sd">        table (str): Table name.</span>

<span class="sd">    Returns:</span>
<span class="sd">        User: The reviewer user.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">current_review</span> <span class="o">=</span> <span class="n">PeerReview</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">current_review</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">current_review</span><span class="p">,</span> <span class="s2">&quot;reviewer&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">current_review</span><span class="o">.</span><span class="n">reviewer</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#dataedit.models.PeerReviewManager.save" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Override the save method to perform additional logic
before saving the peer review manager.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override the save method to perform additional logic</span>
<span class="sd">    before saving the peer review manager.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Set is_open_since field if it is None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_open_since</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Get the associated PeerReview instance</span>
        <span class="n">peer_review</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opr</span>

        <span class="c1"># Set is_open_since based on the days_open property of the</span>
        <span class="c1"># PeerReview instance</span>
        <span class="n">days_open</span> <span class="o">=</span> <span class="n">peer_review</span><span class="o">.</span><span class="n">days_open</span>
        <span class="k">if</span> <span class="n">days_open</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_open_since</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">days_open</span><span class="p">)</span>
    <span class="c1"># Call the parent class&#39;s save method to save the PeerReviewManager instance</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.set_next_reviewer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_next_reviewer</span><span class="p">()</span></code>

<a href="#dataedit.models.PeerReviewManager.set_next_reviewer" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Set the order on which peer will be required to perform a action to
continue with the process.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_next_reviewer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set the order on which peer will be required to perform a action to</span>
<span class="sd">    continue with the process.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO:check for user identifies as ...</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">==</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.update_open_since" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_open_since</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#dataedit.models.PeerReviewManager.update_open_since" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Update the "is_open_since" field of the peer review manager.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>opr</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="dataedit.models.PeerReview" href="#dataedit.models.PeerReview">PeerReview</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The peer review.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">update_open_since</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">opr</span><span class="p">:</span> <span class="n">PeerReview</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the &quot;is_open_since&quot; field of the peer review manager.</span>

<span class="sd">    Args:</span>
<span class="sd">        opr (PeerReview): The peer review.</span>
<span class="sd">        If None, use the peer review associated with the manager.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">opr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">peer_review_manager</span> <span class="o">=</span> <span class="n">PeerReviewManager</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">opr</span><span class="o">=</span><span class="n">opr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">peer_review_manager</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>

    <span class="n">days_open</span> <span class="o">=</span> <span class="n">peer_review_manager</span><span class="o">.</span><span class="n">opr</span><span class="o">.</span><span class="n">days_open</span>
    <span class="n">peer_review_manager</span><span class="o">.</span><span class="n">is_open_since</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">days_open</span><span class="p">)</span>

    <span class="c1"># Call the parent class&#39;s save method to save the PeerReviewManager instance</span>
    <span class="n">peer_review_manager</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="dataedit.models.PeerReviewManager.whos_turn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">whos_turn</span><span class="p">()</span></code>

<a href="#dataedit.models.PeerReviewManager.whos_turn" class="headerlink" title="Permanent link">#</a></h4>


    <div class="doc doc-contents ">

        <p>Get the user and role (contributor or reviewer) whose turn it is.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[str, User]: The role and user.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>dataedit/models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">whos_turn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the user and role (contributor or reviewer) whose turn it is.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[str, User]: The role and user.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">role</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
    <span class="n">peer_review</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">opr</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_reviewer</span> <span class="o">==</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">REVIEWER</span><span class="o">.</span><span class="n">value</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">peer_review</span><span class="o">.</span><span class="n">reviewer</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">Reviewer</span><span class="o">.</span><span class="n">CONTRIBUTOR</span><span class="o">.</span><span class="n">value</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">peer_review</span><span class="o">.</span><span class="n">contributor</span>

    <span class="k">return</span> <span class="n">role</span><span class="p">,</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.indexes", "navigation.path", "navigation.tracking", "navigation.top", "toc.follow", "search.suggest", "search.share", "content.tabs.link"], "search": "../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>
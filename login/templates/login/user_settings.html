{% extends "base/base-profile.html" %}
{% load django_bootstrap5 %}
{% load static %}
{% block main-content-body %}
{% include "login/user_nav.html" %}

{% if profile_user == request.user %}
<h2 class="header">Your Security Information</h2>
<table class="table">
        <tr>
            <th> API-Token: </th>
            <td>
                <a id="toggler" href="#" onclick="toggler('token');">Show token</a>
                <div style="display:none" id="token">
                {% if token %}
                     {{ token }}
                {% endif %}
                </div>
            </td>
        </tr>
        <tr>
            <th> Password </th>
            <td>
                <a href="password_change">Change your password</a>
            </td>
        </tr>
        {% comment %}
        {# TODO: implement tests before we allow user deletion  #}
        <tr>
            <th> Account </th>
            <td>
                <a href="{% url 'account-delete' request.user.id %}">Delete your account</a>
            </td>
        </tr>
        {% endcomment %}
</table>
    <br>
    {% if request.user.is_authenticated and request.user == user%}
        <hr>
        <h2 class="header">Manage Profile</h2>
        <div style="overflow: hidden;">
<a href="{% url 'edit' request.user.id %}" class="btn btn-secondary">Edit</a>
        </div>
        <hr>
        <h2 class="header">Manage Groups</h2>
        <div style="overflow: hidden;">
            <a href="/user/groups/" class="btn btn-secondary">Manage Groups</a>
        </div>
    {% endif %}
{% endif %}
{% endblock %}

{% block main-right-sidebar-content %}
{% if profile_user == request.user %}
<div class="profile-sidebar">
    <div class="profile-sidebar__img">
        {% if profile_user.profile_img %}
        <img class="rounded-circle account-img" src="{{ profile_user.profile_img.url }}" width="200" height="200" alt="Profile picture">
        {% else %}
        <svg width="100" height="100" fill="currentColor" version="1.1" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <g>
                <path d="m90.469 80.945v-9.5234h-4.7617v-4.7617h-4.7617v-4.7617h-4.7617v-4.7773h-14.285v4.7773h-9.5234v0.019531h-14.297v-4.7773h-14.285v4.7773h-4.7617v4.7617h-4.7617v4.7617h-4.7617v9.5234l-4.7461-0.003906v14.293h47.652v-0.019531h42.848v-14.293zm0 9.5195h-38.094v0.019531h-42.867v-4.7617h4.7617v-9.5234h4.7617v-4.7617h4.7617v-4.7617h4.7617v-4.7617h4.7617v4.7617h19.074v-0.019531h14.27v-4.7617h4.7617v4.7617h4.7617v4.7617h4.7617v4.7617h4.7617v9.5234h4.7617z"/>
                <path d="m71.43 19.027v-4.7617h-4.7617v-4.7617h-4.7617v-4.7539h-9.5234v0.019531h-14.312v4.7617h-4.7617v4.7617h-4.7617v4.7617h-4.7617v19.047h4.7617v4.7617h4.7617v4.7617h4.7617v4.7695h14.312v-0.019531h9.5234v-4.7695h4.7617v-4.7617h4.7617v-4.7617h4.7617v-19.047l-4.7617-0.003906zm0 9.5234v4.7617h-4.7617v4.7617h-4.7617v4.7617h-4.7617v4.7617h-4.7617v0.019532h-9.5508v-4.7617h-4.7617v-4.7617h-4.7617v-4.7617h-4.7617v-9.5234h4.7617v-4.7617h4.7617v-4.7617h4.7617v-4.7617h9.5508l0.003907-0.015626h4.7617v4.7617h4.7617v4.7617h4.7617v4.7617h4.7617z"/>
            </g>
        </svg>
    {% endif %}
    </div>
    <div class="profile-sidebar__block">
        <div><p class="profile-sidebar__name"> {{ profile_user.name }} </p></div>
        <p> 
            {% if profile_user.fullname %}
                {{ profile_user.fullname }}
            {% else %}
                No full name added
            {% endif %}
        </p>
        <p>Member since {{ profile_user.registration_date|date:"d/m/Y" }}</p>
    </div>
    <div class="profile-sidebar__block">
        <p>
            {% if profile_user.work %}
                {{ profile_user.work }}
            {% else %}
                No profession added
            {% endif %}
        </p>
        <p> 
            {% if profile_user.location %}
                {{ profile_user.location }}
            {% else %}
                No location added
            {% endif %}
        </p>
        <p> 
            {% if profile_user == request.user %}
                {{ profile_user.email }} 
            {% endif %}
        </p>
        <p> 
            {% if profile_user.linkedin %}
                <a href="{{ profile_user.linkedin }}">{{ profile_user.linkedin }}</a>
            {% else %}
                No LinkedIn page added
            {% endif %}
        </p>
        <p> 
            {% if profile_user.facebook %}
                <a target="_blank" href="{{ profile_user.facebook }}">{{ profile_user.facebook }}</a>
            {% else %}
                No Facebook page added
            {% endif %}
        </p>
        <p> 
            {% if profile_user.twitter %}
                <a href="{% url 'edit' request.user.id %}">{{ profile_user.twitter }}</a>
            {% else %}
                No Twitter added
            {% endif %}
        </p>
    </div>
</div>
    
    <table class="table">

    <tr>
        <th style="width:20%"> Affiliation: </th>
        <td>
            {% if profile_user.affiliation %}
                {{ profile_user.affiliation }}
            {% elif profile_user == request.user %}
                No affiliation added.
            {% else %}
                -
            {% endif %}
        </td>
    </tr>
    <tr>
        <th> Description: </th>
        <td> 
            {% if profile_user.description %}
                {{ profile_user.description }}
            {% else %}
                No description added.
            {% endif %} 
        </td>
    </tr>
</table>
{% endif %}
{% endblock %}

